[ZONE WGCAL:WGCAL_HTMLHEAD]

<script type="text/javascript">

var families = new Array();
var nfam = 0;
function SetFamily(fid, classSet, classUnset) {
  elt = document.getElementById(fid);
  var idx = -1;
  families.sort();
  for (i=0; i<families.length && idx==-1; i++) {
    if (families[i] == fid) idx = i;
  }
  if (idx!=-1) {
    families[idx] = -1;    
    css = classUnset;
  } else {
    for (i=0; i<families.length && families[i]!=-1; i++);
    families[i] = fid;
    css = classSet;
  }
  document.getElementById('sfam').value = '';
  nfam = 0;
  for (i=0; i<families.length; i++) {
    if (families[i]!=-1) {
      document.getElementById('sfam').value += families[i]+'|';
      nfam++;
    }
  }
  if (nfam>0) {
    document.getElementById('szone').style.display = '';
    document.getElementById('stext').focus();
  } else {
    document.getElementById('szone').style.display = 'none';
  }
  elt.className = css;
}

function SelectRessource(fid, ftitle, ficon, st, tst, cst) {
  top.opener.addRessource(fid, ftitle, ficon, 0, tst, cst)
  elt = document.getElementById(fid);
  elt.style.display = 'none';
}

</script>

<form id="fgettext" target="wgcal_mresspicker_list" name="fgettext" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_RESSPICKERLIST&updt=[updt]">
<fieldset><legend>[TEXT:searched families]&nbsp;
<img style="cursor:pointer;" title=[TEXT:close window]" height="12" src="WGCAL/Images/wm-close-small.png" onclick="parent.window.close();">&nbsp;</legend>
[BLOCK FAMRESS]
<div id="[FAMID]"  class="WGCRessDefault" style="height:50%; overflow:auto"
     onmouseover="WGCalChangeClass(event, '[FAMID]', 'WGCFamSelected', 'WGCRessOver');" 
     onmouseout="WGCalChangeClass(event, '[FAMID]', 'WGCFamSelected', 'WGCRessDefault');"
     onclick="SetFamily('[FAMID]', 'WGCFamSelected', 'WGCRessDefault');" >
  <img height="15"  src="[FAMICON]" title="[FAMTITLE]"/>[FAMTITLE]
</div>[ENDBLOCK FAMRESS]
<input id="sfam" name="sfam" type="hidden" value="">
<div id="szone" style="display:none">
<hr>
<input id="stext" name="stext" type="text" size="15">
<img id="sbutton" style="cursor:pointer;" onclick="document.getElementById('fgettext').submit();" height="15"
     src="WGCAL/Images/wm-searchiuser.png" title="[TEXT:search]">
</div>
</fieldset>
<fieldset><legend>[TEXT:my prefered contacts]</legend>
[BLOCK PREFCONTACT]
<div id="[ID]"  class="WGCRessDefault" height="50%" style="overflow:auto"
     onmouseover="WGCalChangeClass(event, '[ID]', 'WGCFamSelected', 'WGCRessOver');" 
     onmouseout="WGCalChangeClass(event, '[ID]', 'WGCFamSelected', 'WGCRessDefault');"
     onclick="SelectRessource('[ID]', '[TITLE]', '[ICON]', '[STATE]', '[TSTATE]', '[CSTATE]');" >
  <img height="15"  src="[ICON]" title="[TITLE]"/>[TITLE]
</div>[ENDBLOCK PREFCONTACT]
</div>
</fieldset>
</form>

[ZONE WGCAL:WGCAL_HTMLFOOT]
