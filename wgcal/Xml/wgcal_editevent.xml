[ZONE WGCAL:WGCAL_HTMLHEAD]
<form id="deleteevent" name="deleteevent" method="POST" target="wgcal_calendar" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_DELETEEVENT"> <input type="hidden" id="eventid" name="eventid" value="[EVENTID]"> </form>
<form id="viewdispo" name="viewdispo" method="POST" target="wgcal_dispo" action="[CORE_STANDURL]&app=FDL&action=FDL_CARD&zone=FREEEVENT:PLANNER:T&byres=Y&id=[planid]">
<input id="idres" name="idres" type="hidden" value="">
<input id="jdstart" name="jdstart" type="hidden" value="">
<input id="jdend" name="jdend" type="hidden" value="">
</form>

<form id="editevent" name="editevent" method="POST" target="wgcal_calendar" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_STOREEVENT">
<input type="hidden" id="eventid" name="eventid" value="[EVENTID]">
<input type="hidden" id="ownerid" name="ownerid" value="[ownerid]">
<input type="hidden" id="ownertitle" name="ownertitle" value="[ownertitle]">
<input type="hidden" id="evstatus" name="evstatus" value="[evstatus]">
<input type="hidden" id="evcalendar" name="evcalendar" value="[evcalendar]">
<input type="hidden" id="evconfidentiality" name="evconfidentiality" value="[evconfidentiality]">

<table width="100%" style="margin-top: 0em;">
<tr><td align="right">
<img src="WGCAL/Images/wm-save.png" 
  height="20" title="[TEXT:save]" class="WGCalButton" style="border:0px" onclick="saveEvent();">
<img src="WGCAL/Images/wm-close.png" 
  height="20" title="[TEXT:close]" class="WGCalButton" style="border:0px" onclick="cancelEvent();">
[BLOCK EMPTY][nop]&nbsp;&nbsp;
<a href="mailto:[mailadd]"><img src="WGCAL/Images/wm-mail.png" 
  height="20" title="[TEXT:mail to contacts]" class="WGCalButton" style="border:0px"></a>
<img src="WGCAL/Images/wm-print.png" 
  height="20" title="[TEXT:print]" class="WGCalButton" style="border:0px" onclick="window.print();">
<img src="WGCAL/Images/wm-delete.png" 
  height="20" title="[TEXT:delete]" class="WGCalButton" style="border:0px" onclick="deleteEvent();">
[ENDBLOCK EMPTY]

</td></tr></table>

<fieldset>

<legend>
<img id="butevmainzone" src="WGCAL/Images/wm-rvset.png" class="WGCalZoneSelected"
    height="28" title="[TEXT:set event]" style="border:0px" 
    onClick="SwitchZone('evmainzone'); autoHresize(); autoVresize();" >
<img id="butevrepeatzone" src="WGCAL/Images/wm-repeat.png" class="WGCalZoneDefault"
    height="28"  title="[TEXT:manage repeat]" style="border:0px" 
    onClick="SwitchZone('evrepeatzone'); autoHresize(); autoVresize();" >
<img id="butevattendeeszone" src="WGCAL/Images/wm-attendees.png" class="WGCalZoneDefault"
    height="28" title="[TEXT:add attendees]" style="border:0px" 
    onClick="SwitchZone('evattendeeszone'); autoHresize(); autoVresize();" >
</legend>

<!-- Event default view -->
<br>
<div id="evmainzone" style="display:">

[TEXT:rv title] : <input id="rvtitle" name="rvtitle" size="50" type="text" value="[TITLE]" [TITLERO]>

<table>
<tr>
<td align="right">[TEXT:start date]</td>
<td>
<img style="display:[DATEBUTVIS]; cursor:pointer" id="Brvstart"  alt="[TEXT:start date]" title="[TEXT:start date]" src="WGCAL/Images/cal-other.gif" height="15" >
<span id="Trvstart">[STARTREAD]</span>
<input type="hidden" value="[START]" id="rvstart" name="rvstart" onChange="UpdateEndTime();">

<script type="text/javascript">
  Calendar.setup(
    {
      inputField   : "rvstart",        
      displayArea  : "Trvstart",        
      ifFormat     : "%s",   
      daFormat     : "[DFMT]",
      showsTime    : false,
      button       : "Brvstart",
      date         : new Date([mSTART]),
      weekNumbers  : false,
      firstDay     : 1
    }
  );
</script>
</td>
<td id="start_hour" style="visibility:visible">
<input type="text" size="2" value="[H_START]" [DATERO] id="hrvstart" name="hrvstart" >
:<input size="2" type="text" value="[M_START]" [DATERO] id="mrvstart" name="mrvstart">
</td>
<td >
<span id="tnohour">
<input [NOHOURRO] id="nohour" style="cursor:pointer;" name="nohour" type="checkbox" onclick="ChangeNoHour(false,0);">
[TEXT:no hour]
</span>
<span id="tallday">
<input [ALLDAYRO] id="allday" style="cursor:pointer;" name="allday" type="checkbox" onclick="ChangeAllDay(false,0);"></input>
[TEXT:all the day]
</span>
</td>
</tr>

<tr id="end_hour" style="visibility:visible">
<td align="right">[TEXT:end date] : </td>
<td>
<img style="display:[DATEBUTVIS]; cursor:pointer" id="Brvend"  alt="[TEXT:end date]" title="[TEXT:end date]" src="WGCAL/Images/cal-other.gif" height="15" >
<span id="Trvend">[ENDREAD]</span>
<input type="hidden" value="[END]" id="rvend" name="rvend">
<script type="text/javascript">
  Calendar.setup(
    {
      inputField   : "rvend",        
      displayArea  : "Trvend",        
      ifFormat     : "%s",   
      daFormat     : "[DFMT]",
      showsTime    : false,
      button       : "Brvend",
      date         : new Date([mEND]),
      weekNumbers  : false,
      firstDay     : 1
    }
  );
</script>
</td>
<td>
<input type="text" size="2" value="[H_END]" [DATERO] name="hrvend" id="hrvend" >
:<input size="2" type="text" value="[M_END]" [DATERO] name="mrvend" id="mrvend" >
</td>
<td></td>
</tr>
</table>


<hr>

[TEXT:rv note] : <textarea cols="40" rows="3" id="rvnote" name="rvnote" [DESCRRO]>[DESCR]</textarea>

<hr>

[TEXT:confidentiality] : <select id="rvconfid" onchange="EventSetElement('rvconfid', 'evconfidentiality')" [rvvisro]>[BLOCK RVCONFID]<option value="[value]" [selected]>[descr][ENDBLOCK RVCONFID]</select>

[TEXT:calendar] : <select id="rvcalendar" name="rvcalendar" [[rvcalro]>[BLOCK CALS]<option value="[value]" [selected]>[descr][ENDBLOCK CALS]</select>

[TEXT:status] : <select id="rvstatus" name="rvstatus" [rvstaro]>[BLOCK RVSTATUS]<option value="[value]" [selected]>[descr][ENDBLOCK RVSTATUS]</select>

<hr>

[TEXT:alarm] : <input id="AlarmCheck" name="AlarmCheck" type="checkbox"
                      onClick="ChangeAlarm(-1)" [ALARMRO]>

<span id="AlarmVis" style="display:[ALRMVIS]">
&nbsp;
<select id="alarmhour" name="alarmhour" [ALARMRO]>[BLOCK ALARM_HR]
<option value="[ALRMPERIOD_V]" [ALRMPERIOD_S]>[ALRMPERIOD_V][ENDBLOCK ALARM_HR]
</select>&nbsp;[TEXT:hour]&nbsp;&nbsp;

<select id="alarmmin" name="alarmmin" [ALARMRO]>[BLOCK ALARM_MIN]
<option value="[ALRMPERIOD_V]" [ALRMPERIOD_S]>[ALRMPERIOD_V][ENDBLOCK ALARM_MIN]
</select>&nbsp;[TEXT:minutes]&nbsp;[TEXT:before]

</span>

</div>


<!-- Repeat zone -->

<div id="evrepeatzone" style="display:none">


<div>

  <div style="width:100%; left:20px;">
   [TEXT:every] : 
    <input onclick="everyInfo()" type="radio" id="repeattype0" name="repeattype" value="0" [repeatdis] [REPEATTYPE_0]>[TEXT:none]
    <input onclick="everyInfo()" type="radio" id="repeattype1" name="repeattype" value="1" [repeatdis] [REPEATTYPE_1]>[TEXT:day]
    <input onclick="everyInfo()" type="radio" id="repeattype2" name="repeattype" value="2" [repeatdis] [REPEATTYPE_2]>[TEXT:week]
    <input onclick="everyInfo()" type="radio" id="repeattype3" name="repeattype" value="3" [repeatdis] [REPEATTYPE_3]>[TEXT:month]
    <input onclick="everyInfo()" type="radio" id="repeattype4" name="repeattype" value="4" [repeatdis] [REPEATTYPE_4]>[TEXT:year]
   ([TEXT:frequency] <input id="rfrequency" name="rfrequency" size="1" type="text" value="[FREQVALUE]" [repeatdis]>)
  </div>

<br>

  <div id="d_rweekday" style="left:10%; width:100%; align:center; display:[D_RWEEKDISPLAY]">
   [TEXT:day repetition] : <br>
    <input type="radio" id="rweekday" name="rweekday" value="1" [repeatdis] [D_RWEEKDISPLAY_1]>[TEXT:monday]
    <input type="radio" id="rweekday" name="rweekday" value="2" [repeatdis] [D_RWEEKDISPLAY_2]>[TEXT:tuesday]
    <input type="radio" id="rweekday" name="rweekday" value="3" [repeatdis] [D_RWEEKDISPLAY_3]>[TEXT:wenesday]
    <input type="radio" id="rweekday" name="rweekday" value="4" [repeatdis] [D_RWEEKDISPLAY_4]>[TEXT:thurday]
    <input type="radio" id="rweekday" name="rweekday" value="5" [repeatdis] [D_RWEEKDISPLAY_5]>[TEXT:friday]
    <input type="radio" id="rweekday" name="rweekday" value="6" [repeatdis] [D_RWEEKDISPLAY_6]>[TEXT:saturday]
    <input type="radio" id="rweekday" name="rweekday" value="7" [repeatdis] [D_RWEEKDISPLAY_7]>[TEXT:sunday]
    <br>
  </div>

  <div id="d_rmonth" style="left:10%; display:[D_RMONTH]">
   [TEXT:month repetition] : <br>
    <input type="radio" id="rmonth" name="rmonth" value="0" [repeatdis] [D_RMONTH_DATE_CHECKED]>[TEXT:per date]
    <input type="radio" id="rmonth" name="rmonth" value="1" [repeatdis] [D_RMONTH_DAY_CHECKED]>[TEXT:per day]
    <br>
  </div>

</div>


<div width="100%">

  <br>[TEXT:repeat until] : 
  <input type="radio" id="runtil" name="runtil" onClick="ViewElement('runtild', 'vrununtil');" 
         value="0" [D_RUNTIL_INFI] [repeatdis]>[TEXT:forever]
  <input type="radio" id="runtild" name="runtil" onClick="ViewElement('runtild', 'vrununtil');" 
         value="1" [D_RUNTIL_DATE] [repeatdis]>[TEXT:this date]&nbsp;:&nbsp;

 <span id="vrununtil" style="display:[RUNUNTIL_DATE_DISPLAY]">

 <img style="display:[repeatvie]; cursor:pointer" id="runtildatebutton"  name="runtildatebutton" 
      title="[TEXT:click to select a date]"  height="15" src="WGCAL/Images/cal-other.gif">

 <input type="hidden" id="Vruntildate" name="Vruntildate" value="">
 <span id="runtildate">[uDate]</span>
 <script type="text/javascript">
    Calendar.setup(
      {
        inputField   : "Vruntildate",        
        displayArea  : "runtildate",        
        ifFormat     : "%s",   
        daFormat     : "[DFMT]",
        showsTime    : false,
        button       : "runtildatebutton",
        date         : new Date([umDate]),
        weekNumbers  : false,
        firstDay     : 1
      }
    );
   </script></span>

<hr>

<fieldset><legend>[TEXT:exclude days]</legend>

<span style="display:[repeatvie]">
<img id="nexcldatebut" name="nexcldatebut"
     title="[TEXT:add a new day to exclude]" style="cursor:pointer" 
     height="12" src="WGCAL/Images/wgcal-plus.gif">
<br>
<img title="[TEXT:del selected dates]" onClick="delExclDate()" 
     height="12" src="WGCAL/Images/wgcal-minus.gif">
</span>

<span>
<select id="listexcldate" name="listexcldate[]" width="20" size="5" multiple>
[BLOCK EXCLDATE]<option id="exdate[iDate]" value="[mDate]">[rDate]</option>[ENDBLOCK EXCLDATE]
</select>
</span>

<input onChange="addExclDate();" type="hidden" id="nexcldate" >
<script type="text/javascript">
Calendar.setup(
    {
        inputField   : "nexcldate",        
        ifFormat     : "%s",   
        showsTime    : false,
        button       : "nexcldatebut",
        date         : new Date(),
        weekNumbers  : false,
        firstDay     : 1
      }
    );
</script>
</fieldset>

</div>

</div> <!-- end of repeat zone -->

<span style="display:none"><select  id="attendees" name="attendees[]" multiple></select></span>

<div id="evattendeeszone" style="display:none">

<fieldset id='vical' class="WGCListRess">
  <legend class="WGCToolTitle">[TEXT:attendees]&nbsp;

  <img id="addattendee" style="display:[attendeesro]; cursor:pointer;" 
     onclick="attpicker = subwindow(300, 400, 'CalPicker', '[CORE_STANDURL]&app=WGCAL&action=WGCAL_RESSPICKER_MAIN');" 
     height="20"
     src="WGCAL/Images/wm-attendees.png" title="[TEXT:add attendees]">

   <img id="viewplan" style="cursor:pointer;" height="20"
          onclick="viewattdispo();";
          src="WGCAL/Images/wm-planner.png" title="[TEXT:vew disponibility]">

  </legend>

<div id="attlist">
 
<table cellspacing="0" cellpadding="0">
<tbody id="tabress">

<tr style="display:none" id="trsample">
<td> <img style="display:[attendeesro];cursor:pointer;border:1px outset grey" height="8"  
          src="WGCAL/Images/wgcal-suppress.gif" 
          onclick="deleteAttendee('%RID%');" 
          title="[TEXT:delete attendee] %RDESCR%">
</td>
<td>&nbsp;&nbsp;</td>
<td nowrap>
  <span id="%RID%" width="90%">
    <img id="im%RID%" width="20px" height="20px" align="absbottom" src="%RICON%">&nbsp;%RDESCR%
  </span>
</td>
<td>&nbsp;</td>
<td><span id="cp%RID%" name="cp%RID%" style="border:1px inset grey;" 
          title="[TEXT:event state ] %RSTATE%">&nbsp;&nbsp;</span></td>
</tr>
</tbody>
</table>

</div>

</fieldset>
</div>




<script type="text/javascript">
 ChangeNoHour(true, [NOHOUR]);
 ChangeAllDay(true, [ALLDAY]);
 ChangeAlarm([ALARM]);

 [BLOCK ADD_RESS] addRessource([attId], '[attTitle]', '[attIcon]',  '[attState]');
 [ENDBLOCK ADD_RESS] 
 //window.onunload = cancelEvent;
 document.getElementById('rvtitle').focus();
</script>

</form>

[ZONE WGCAL:WGCAL_HTMLFOOT]
 
