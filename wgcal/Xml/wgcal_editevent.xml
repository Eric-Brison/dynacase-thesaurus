[ZONE WGCAL:WGCAL_HTMLHEAD]
<form id="deleteevent" name="deleteevent" method="POST" target="wgcal_calendar" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_DELETEEVENT"> <input type="hidden" id="eventid" name="eventid" value="[EVENTID]"> </form>
<form id="viewdispo" name="viewdispo" method="POST" target="wgcal_dispo" action="[CORE_STANDURL]&app=FDL&action=FDL_CARD&zone=FREEEVENT:PLANNER:T&byres=Y&id=[planid]">
<input id="idres" name="idres" type="hidden" value="">
<input id="jdstart" name="jdstart" type="hidden" value="">
<input id="jdend" name="jdend" type="hidden" value="">
</form>

<form id="editevent" name="editevent" method="POST" target="wgcal_calendar" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_STOREEVENT">
<input type="hidden" id="eventid" name="eventid" value="[EVENTID]">
<input type="hidden" id="ownerid" name="ownerid" value="[ownerid]">
<input type="hidden" id="ownertitle" name="ownertitle" value="[ownertitle]">
<input type="hidden" id="evstatus" name="evstatus" value="[evstatus]">
<input type="hidden" id="evcalendar" name="evcalendar" value="[evcalendar]">
<input type="hidden" id="evconfidentiality" name="evconfidentiality" value="[evconfidentiality]">
<input type="hidden" id="attendees" name="attendees" value="">
<input type="hidden" id="excludedate" name="excludedate" value="">


<table width="100%" style="margin-top: 0em;">
<tr>
<td></td>
<td align="right"><span id="spall" style="visibility:[vStatus]; border:1px solid [cState]">[BLOCK STATUSZ]
<span style="cursor:pointer" margin:0px; padding:0px" id="sp[iState]" onclick="clickB2('cbstate[iState]'); setStatus([vState], '[cState]');" style="cursor:pointer" onmouseover="this.style.background='[cState]'" onmouseout="this.style.background=''">[tState] <input onclick="clickB2('cbstate[iState]'); setStatus([vState], '[cState]')" type="radio" id="cbstate[iState]" name="evstatus" value="[vState]" [sState] [rState]></span>
[ENDBLOCK STATUSZ]</span></td>
<td align="right">
[BLOCK EMPTY][nop]&nbsp;&nbsp;
<a href="mailto:[mailadd]"><img src="WGCAL/Images/wm-mail.png" 
  height="20" title="[TEXT:mail to contacts]" class="WGCalAction" style="border:0px"></a>
<img src="WGCAL/Images/wm-print.png" 
  height="20" title="[TEXT:print]" class="WGCalAction" onclick="window.print();">
<img src="WGCAL/Images/wm-delete.png" 
  height="20" title="[TEXT:delete]" class="WGCalAction" onclick="deleteEvent('[TEXT: delete this event]');">
[ENDBLOCK EMPTY]
</td></tr></table>


<fieldset>
<legend>
<img id="butevmainzone" src="WGCAL/Images/wm-rvset.png" class="WGCalZoneSelected"
    height="28" title="[TEXT:set event]" style="border:0px" 
    onClick="SwitchZone('evmainzone'); autoHresize(); autoVresize();" >
<img id="butevrepeatzone" src="WGCAL/Images/wm-repeat.png" class="WGCalZoneDefault"
    height="28"  title="[TEXT:manage repeat]" style="border:0px" 
    onClick="SwitchZone('evrepeatzone'); autoHresize(); autoVresize();" >
</legend>

<!-- Event default view -->
<br>
<div id="evmainzone" style="display:">

<table width="100%" style="margin-top: 0em;" cellspacing="0" border="0">

<tr>

<td colspan="3" style="padding-top:4px; padding-bottom:2em;"><input onfocus="document.getElementById('errTitle').style.display='none'; this.style.background='';" class="Mandatory" id="rvtitle" name="rvtitle" size="40" type="text" title="[TEXT:rv title]" value="[TITLE]" [TITLERO]><div id="errTitle" name="errTitle" style="width:100px; display:none; background-color:white; margin: 2em; padding:1em; border:2px inset red; color:red; position:absolute" onclick="this.style.display='none'">[TEXT:give a title]</div></td>
<td width="8%"  rowspan="4"></td>
<td rowspan="4">[TEXT:rv note]<br><textarea cols="40" rows="3" id="rvnote" name="rvnote" [DESCRRO]>[DESCR]</textarea></td>

</tr>

<tr>
<td align="right">[TEXT:start date] : </td>
<td align="center">
<div id="tUstart" name="tUstart" style="display:none; background-color:white; margin: 2em; padding:1em; border:2px inset red; color:red; position:absolute" onclick="this.style.display='none'">[TEXT:start time update according end time]</div>
<span onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''" id="Bstart" style="cursor:pointer;"
      title="[TEXT:click here to enter the start date]">
<img style="display:[DATEBUTVIS]" src="WGCAL/Images/cal-other.gif" height="15" >&nbsp;<span id="Tstart">[STARTREAD]</span></span>
<input type="hidden" value="[START]" id="Dstart" name="Dstart" onChange="ComputeTime('start');">
<input type="hidden" value="[FSTART]" id="Fstart" name="Fstart">
<script type="text/javascript">
  Calendar.setup(
    {
      inputField   : "Dstart",        
      displayArea  : "Tstart",        
      ifFormat     : "%s",   
      daFormat     : "[DFMT]",
      showsTime    : false,
      button       : "Bstart",
      date         : new Date([mSTART]),
      weekNumbers  : false,
      firstDay     : 1
    }
  );
</script>
</td>

<td id="start_hour" align="left" style="visibility:[HVISIBLE]">
<input type="text" size="2" value="[H_START]" [DATERO] id="Hstart" name="Hstart" onchange="ComputeTime('start');">
:<input size="2" type="text" value="[M_START]" [DATERO] id="Mstart" name="Mstart" onchange="ComputeTime('start');">
</td>

</tr>

<tr>
<td align="right" id="end_hour1" style="visibility:[HVISIBLE]">[TEXT:end date] : </td>
<td align="center" id="end_hour2" style="visibility:[HVISIBLE]">
<div id="tUend" name="tUend" style="display:none; background-color:white; margin: 2em; padding:1em; border:2px inset red; color:red; position:absolute" onclick="this.style.display='none'">[TEXT:end time update according start time]</div>
<span onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''" id="Bend" style="cursor:pointer;"
      title="[TEXT:click here to enter the end date]">
<img style="display:[DATEBUTVIS];" src="WGCAL/Images/cal-other.gif" height="15">&nbsp;<span id="Tend">[ENDREAD]</span></span>
<input type="hidden" value="[END]" id="Dend" name="Dend" onchange="ComputeTime('end');">
<input type="hidden" value="[FEND]" id="Fend" name="Fend">
<script type="text/javascript">
  Calendar.setup(
    {
      inputField   : "Dend",
      displayArea  : "Tend",
      ifFormat     : "%s",
      daFormat     : "[DFMT]",
      showsTime    : false,
      button       : "Bend",
      date         : new Date([mEND]),
      weekNumbers  : false,
      firstDay     : 1
    }
  );
</script>
</td>

<td align="left" id="end_hour3" style="visibility:[HVISIBLE]">
<input type="text" size="2" value="[H_END]" [DATERO] name="Hend" id="Hend" onchange="ComputeTime('end');">
:<input size="2" type="text" value="[M_END]" [DATERO] name="Mend" id="Mend" onchange="ComputeTime('end');">
</td>
</tr>

<tr>
<td colspan="3" align="center">
<span id="tnohour" style="cursor:pointer; visibility:[NOHOURDISP]"
      onclick="if (clickB('nohour')) ChangeNoHour(false,0);"
      onmouseover="this.style.background='[CORE_BGCOLORALTERN]'"
      onmouseout="this.style.background=''">
<input [NOHOURINIT] [NOHOURRO] id="nohour" style="cursor:pointer;" name="nohour" type="checkbox" onclick="if (clickB('nohour')) ChangeNoHour(false,0);">
[TEXT:no hour]
</span>
<span id="tallday" style="cursor:pointer; visibility:[ALLDAYDISP]" 
      onclick="if (clickB('allday')) ChangeAllDay(false,0);" 
      onmouseover="this.style.background='[CORE_BGCOLORALTERN]'"
      onmouseout="this.style.background=''">
<input [ALLDAYINIT] [ALLDAYRO] id="allday" style="cursor:pointer;" name="allday" type="checkbox" onclick="if (clickB('allday')) ChangeAllDay(false,0);"></input>
[TEXT:all the day]
</span>
</td>
</tr>

</table>

<br>

<table width="100%" cellspacing="0" border="0">

<tr>

<td width="50%" rowspan="5">

<div id="evattendeeszone" style="display:">

<fieldset id='vical'>
  <legend class="WGCToolTitle">[TEXT:attendees]&nbsp;

  <img id="addattendee" style="display:[attendeesro]; cursor:pointer;" 
     onclick="attpicker = subwindow(300, 400, 'CalPicker', '[CORE_STANDURL]&app=WGCAL&action=WGCAL_RESSPICKER_MAIN');" 
     height="20"
     src="WGCAL/Images/wm-attendees.png" title="[TEXT:add attendees]">

   <img id="viewplan" style="display:[voneatt]; cursor:pointer;" height="20"
          onclick="viewattdispo();";
          src="WGCAL/Images/wm-planner.png" title="[TEXT:vew disponibility]">

   <img id="delall" style="display:[voneatt]; cursor:pointer;" height="20"
          onclick="ok=confirm('[TEXT:confirm delete all attendees]'); if (ok) deleteAttendee(-1);";
          src="WGCAL/Images/wm-delete.png" title="[TEXT:delete all attendees]">

  </legend>

<div id="errAtt" name="errAtt" style="width:100px; display:none; background-color:white; margin: 2em; padding:1em; border:2px inset red; color:red; position:absolute" onclick="this.style.display='none'">[TEXT:one ressource or you in event]</div>

<div id="attlist">
 
<table cellspacing="0" cellpadding="0">
<tbody id="tabress">

<tr style="display:none" id="trsample">
<td> <img style="display:[attendeesro];cursor:pointer;border:1px outset grey" height="12"  
          onmouseover="this.style.border='1px inset grey'"
          onmouseout="this.style.border='1px outset grey'"
          src="WGCAL/Images/wm-delete.png" 
          onclick="deleteAttendee('%RID%');" 
          title="[TEXT:delete attendee] %RDESCR%">
</td>
<td>&nbsp;&nbsp;</td>
<td nowrap>
  <span style="cursor:crosshair; border-bottom:1px solid white" id="%RID%" width="90%" title="[TEXT:event state ]%RSTATE%">
    <img id="im%RID%" width="20px" height="20px" align="absbottom" src="%RICON%">&nbsp;%RDESCR%
  </span>
</td>
<td>&nbsp;</td>
<td><span id="cp%RID%" name="cp%RID%" style="cursor:crosshair; border:1px inset grey;" 
          title="[TEXT:event state ] %RSTATE%">&nbsp;&nbsp;</span></td>
</tr>

</tbody>
</table>

<table width="100%" cellspacing="0" cellpadding="0">
<tr id="vnatt" style="display:[vnatt]"><td align="right">
<span style="cursor:pointer;" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''" onclick="ShowHideStatus();" title="[TEXT:I participe to this meeting]">[TEXT:I participe to this meeting]<input id="withMe" name="withMe" type="checkbox" style="cursor:pointer;" onclick="ShowHideStatus();" [WITHME] [WITHMERO]></span></td></tr>
</table>

</div>

</fieldset>
</div>

</td>

<td width="8%"></td>

<td>

<table cellspacing="0" cellpadding="0">

</td></tr>
<tr>
<td colspan="2" align="right">[TEXT:confidentiality]&nbsp;:&nbsp;</td>
<td><select id="rvconfid" onchange="SetSelectedItem('rvconfid', 'evconfidentiality')" [rvvisro]>[BLOCK RVCONFID]<option value="[value]" [selected]>[descr][ENDBLOCK RVCONFID]</select>
</td>
</tr>

<tr>
<td colspan="2" align="right">[TEXT:calendar]&nbsp;:&nbsp;</td>
<td><select id="rvcalendar" name="rvcalendar" onchange="SetSelectedItem('rvcalendar', 'evcalendar');" [rvcalro]>[BLOCK CALS]<option value="[value]" [selected]>[descr][ENDBLOCK CALS]</select>
</td>
</tr>

<tr>
<td colspan="2" align="right"><span style="cursor:pointer" onclick="ChangeAlarm()" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''">[TEXT:alarm]&nbsp;<input id="AlarmCheck" name="AlarmCheck" type="checkbox" style="cursor:pointer" onClick="ChangeAlarm()" [ALARMCHK] [ALARMRO]></span>&nbsp;&nbsp;</td>
<td>
<span id="AlarmVis" style="visibility:[ALRMVIS]">
<select id="alarmhour" name="alarmhour" [ALARMRO]>[BLOCK ALARM_HR]
<option value="[ALRMPERIOD_V]" [ALRMPERIOD_S]>[ALRMPERIOD_V][ENDBLOCK ALARM_HR]
</select>h&nbsp; <select id="alarmmin" name="alarmmin" [ALARMRO]>[BLOCK ALARM_MIN]
<option value="[ALRMPERIOD_V]" [ALRMPERIOD_S]>[ALRMPERIOD_V][ENDBLOCK ALARM_MIN]
</select>mn&nbsp;[TEXT:before]
</span>
</td>
</tr>

</table>

</td>
</tr>
</table>





</div>


<!-- Repeat zone -->

<div id="evrepeatzone" style="display:none">


<div>

  <div style="width:100%; left:20px;">
   [TEXT:every] : 
<span onclick="if (clickB('repeattype0')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype0')) everyInfo()" type="radio" id="repeattype0" name="repeattype" value="0" [repeatdis] [REPEATTYPE_0]>[TEXT:none]</span>
<span onclick="if (clickB('repeattype1')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype1')) everyInfo()" type="radio" id="repeattype1" name="repeattype" value="1" [repeatdis] [REPEATTYPE_1]>[TEXT:day]</span>
<span onclick="if (clickB('repeattype2')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype2')) everyInfo()" type="radio" id="repeattype2" name="repeattype" value="2" [repeatdis] [REPEATTYPE_2]>[TEXT:week]</span>
<span onclick="if (clickB('repeattype3')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype3')) everyInfo()" type="radio" id="repeattype3" name="repeattype" value="3" [repeatdis] [REPEATTYPE_3]>[TEXT:month]</span>
<span onclick="if (clickB('repeattype4')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype4')) everyInfo()" type="radio" id="repeattype4" name="repeattype" value="4" [repeatdis] [REPEATTYPE_4]>[TEXT:year]</span>
   ([TEXT:frequency] <input id="rfrequency" name="rfrequency" size="1" type="text" value="[FREQVALUE]" [repeatdis]>)
  </div>

<br>

  <div id="d_rweekday" style="left:10%; width:100%; align:center; display:[RWEEKDISPLAY]">
   [TEXT:day repetition] : <br>
[BLOCK D_RWEEKDISPLAY]<span onclick="clickB('rweekday[dayn]')" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="clickB('rweekday[dayn]')" type="checkbox" id="rweekday[dayn]" name="rweekday[]" value="[dayn]" [repeatdis]>[tDay]</span>[ENDBLOCK D_RWEEKDISPLAY]
  </div>

  <div id="d_rmonth" style="left:10%; display:[D_RMONTH]">
   [TEXT:month repetition] : <br>
    <span onclick="clickB('rmonth0')" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="clickB('rmonth0')"  type="radio" id="rmonth0" name="rmonth" value="0" [repeatdis] [D_RMONTH_DATE_CHECKED]>[TEXT:per date]</span>
    <span onclick="clickB('rmonth1')" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="clickB('rmonth1')"  type="radio" id="rmonth1" name="rmonth" value="1" [repeatdis] [D_RMONTH_DAY_CHECKED]>[TEXT:per day]</span>
    <br>
  </div>

</div>


<div width="100%">

  <br>[TEXT:repeat until] : 
  <span onclick="if (clickB('runtil')) ViewElement('runtild', 'runtildatebutton');" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input type="radio" id="runtil" name="runtil" onClick="if (clickB('runtil')) ViewElement('runtild', 'runtildatebutton');"
         value="0" [D_RUNTIL_INFI] [repeatdis]>[TEXT:forever]</span>
  <span onclick="if (clickB('runtild')) ViewElement('runtild', 'runtildatebutton');" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input type="radio" id="runtild" name="runtil" onClick="if (clickB('runtild')) ViewElement('runtild', 'runtildatebutton');" 
         value="1" [D_RUNTIL_DATE] [repeatdis]>[TEXT:this date]</span>&nbsp;:&nbsp;

 <span id="runtildatebutton" name="runtildatebutton" style="display:[RUNUNTIL_DATE_DISPLAY]; cursor:pointer" title="[TEXT:click to select a date]" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"> 
 <img style="display:[repeatvie]; cursor:pointer" title="[TEXT:click to select a date]"  height="15" src="WGCAL/Images/cal-other.gif">

 <input type="hidden" id="Vruntildate" name="Vruntildate" value="[Vruntildate]">
 <span id="runtildate">[uDate]</span>
 <script type="text/javascript">
    Calendar.setup(
      {
        inputField   : "Vruntildate",        
        displayArea  : "runtildate",        
        ifFormat     : "%s",   
        daFormat     : "[DFMT]",
        showsTime    : false,
        button       : "runtildatebutton",
        date         : new Date([umDate]),
        weekNumbers  : false,
        firstDay     : 1
      }
    );
   </script></span>

<hr>

<fieldset><legend>[TEXT:exclude days]</legend>

<span style="display:[repeatvie]">
<img id="nexcldatebut" name="nexcldatebut"
     title="[TEXT:add a new day to exclude]" style="cursor:pointer" 
     height="12" src="WGCAL/Images/wgcal-plus.gif">
<br>
<img title="[TEXT:del selected dates]" onClick="delExclDate()" 
     height="12" src="WGCAL/Images/wgcal-minus.gif">
</span>

<span>
<select id="listexcldate" name="listexcldate[]" width="20" size="5" multiple>
[BLOCK EXCLDATE]<option id="exdate[iDate]" value="[mDate]">[rDate]</option>[ENDBLOCK EXCLDATE]
</select>
</span>

<input onChange="addExclDate();" type="hidden" id="nexcldate" >
<script type="text/javascript">
Calendar.setup(
    {
        inputField   : "nexcldate",        
        ifFormat     : "%s",   
        showsTime    : false,
        button       : "nexcldatebut",
        date         : new Date(),
        weekNumbers  : false,
        firstDay     : 1
      }
    );
</script>
</fieldset>

</div>

</div> <!-- end of repeat zone -->

</fieldset>


<table width="100%" style="margin-top: 0em;">
<tr><td align="right">
<img src="WGCAL/Images/wm-save.png" 
  height="20" title="[TEXT:save]" class="WGCalAction" onclick="saveEvent();">
<img src="WGCAL/Images/wm-close.png" 
  height="20" title="[TEXT:cancel]" class="WGCalAction" onclick="cancelEvent('[TEXT: cancel modifications]');">
</td></tr></table>


<script type="text/javascript">
SetModeRo([ROMode]);
[BLOCK ADD_RESS] addRessource([attId], '[attTitle]', '[attIcon]',  '[attState]', '[attLabel]', '[attColor]');
[ENDBLOCK ADD_RESS] 
//window.onunload = cancelEvent;
document.getElementById('rvtitle').focus();
</script>

</form>



[ZONE WGCAL:WGCAL_HTMLFOOT]
 
