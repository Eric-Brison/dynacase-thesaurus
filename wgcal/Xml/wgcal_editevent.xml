[ZONE WGCAL:WGCAL_HTMLHEAD]


<div width="100%" align="right"><input class="inputButton" type="button" id="rvsave" value="[TEXT:save]"></div>


<fieldset>

<legend>
<span id="butevmainzone" title="[TEXT:appointment]" class="WGCalZoneSelected"
      onClick="SwitchZone('evmainzone'); autoHresize(); autoVresize();" >&nbsp;[TEXT:appointment]&nbsp;</span>
<span id="butevrepeatzone" title="[TEXT:repeat]" class="WGCalZoneDefault"
      onClick="SwitchZone('evrepeatzone'); autoHresize(); autoVresize();" >&nbsp;[TEXT:repeat]&nbsp;</span>
<span id="butevattendeeszone" title="[TEXT:attendees]" class="WGCalZoneDefault"
      onClick="SwitchZone('evattendeeszone'); autoHresize(); autoVresize();" >&nbsp;[TEXT:attendees]&nbsp;</span>
</legend>

<!-- Event default view -->

<div id="evmainzone" style="display:">

[TEXT:rv title] : <input id="rvtitle" size="50" type="text" value="[TITLE]">

<hr>

<table>

<tr valign="center">
<td width="50%" id="tnohour">
[TEXT:no hour] : <input id="nohour" name="nohour" type="checkbox" onclick="ChangeNoHour(swstate(NoHourState));">
</td>
<td width="50%" id="tallday">
[TEXT:all the day] : <input id="allday" name="allday" type="checkbox" onclick="ChangeAllDay(swstate(AllDayState));">
</td>
</tr>
</table>

<table>
<tr id="start_hour" style="display:none">
<td>[TEXT:start date] : </td>
<td>
<input type="text" size="10" value="[STARTREAD]" id="rvstart" >
<input type="hidden" value="[START]" id="rvtsstart" name="rvtsstart">
<img style="cursor:pointer" id="lrvstart"  alt="[TEXT:start date]" title="[TEXT:start date]" src="RENDEZVOUS/Images/cal-other.gif">
<input type="text" size="2" value="[H_START]" id="hrvstart" >:<input size="2" type="text" value="[M_START]" id="mrvstart" >

<script type="text/javascript">
  Calendar.setup(
    {
      inputField   : "rvstart",        
      ifFormat     : "%d/%m/%Y",   
      showsTime    : false,
      singleClick  : true,
      button       : "lrvstart",
      date         : new Date([mSTART]),
      firstDay     : 1
    }
  );
</script></td>
</tr>

<tr id="end_hour" style="display:none">
<td>[TEXT:end date] : </td>
<td>
<input type="text" size="10" value="[ENDREAD]" id="rvend" >
<input type="hidden" value="[END]" id="rvtsend" name="rvtsend">
<img style="cursor:pointer" id="lrvend"  alt="[TEXT:end date]" title="[TEXT:end date]" src="RENDEZVOUS/Images/cal-other.gif">
<input type="text" size="2" value="[H_END]" id="hrvend" >:<input size="2" type="text" value="[M_END]" id="mrvend" >
<script type="text/javascript">
  Calendar.setup(
    {
      inputField   : "rvend",        
      ifFormat     : "%d/%m/%Y",   
      showsTime    : false,
      singleClick  : true,
      button       : "lrvend",
      date         : new Date([mEND]),
      firstDay     : 1
    }
  );
</script></td>
<tr>

</table>


<hr>

[TEXT:rv note] : <textarea cols="40" rows="3" id="rvnote" name="rvnote">[DESCR]</textarea>

<hr>

[TEXT:confidentiality] : <select id="rvconfid">
<option value="0" selected>[TEXT:public]
<option value="0">[TEXT:private]
<option value="0">[TEXT:my groups]
</select>

[TEXT:calendar] : <select id="rvcalendar">
<option value="0" selected>[TEXT:my agenda]
<option value="0">[TEXT:birthdays]
<option value="0">[TEXT:school]
</select>
[TEXT:status] : <select id="rvcalendar">
<option value="0" selected>[TEXT:definitive]
<option value="1">[TEXT:to be confirmed]
<option value="2">[TEXT:rejected]
</select>

<hr>

[TEXT:alarm] : <input id="AlarmCheck" type="checkbox"
                      onClick="ChangeAlarm(-1)" >

<span id="AlarmVis"">
&nbsp;
<select id="alarmhour" name="alarmhour">[BLOCK ALARM_HR]
<option value="[ALRMPERIOD_V]" [ALRMPERIOD_S]>[ALRMPERIOD_V][ENDBLOCK ALARM_HR]
</select>&nbsp;[TEXT:hour]&nbsp;&nbsp;

<select id="alarmmin" name="alarmmin">[BLOCK ALARM_MIN]
<option value="[ALRMPERIOD_V]" [ALRMPERIOD_S]>[ALRMPERIOD_V][ENDBLOCK ALARM_MIN]
</select>&nbsp;[TEXT:minutes]&nbsp;[TEXT:before]

</span>

</div>


<!-- Repeat zone -->
<script type="text/javascript">

function ViewElement(eCheck, eDisplay) {
  chk = document.getElementById(eCheck);
  zon = document.getElementById(eDisplay);
  if (chk.checked == true) {
    zon.style.display = '';
  } else {
    zon.style.display = 'none';
  }
}

function everyInfo() {
  var checkone = -1;
  evr = document.getElementsByName('repeattype');
  for (i=0; i<evr.length; i++) {
    if (evr[i].checked) checkone = i;
  }

  document.getElementById('d_rweekday').style.display = 'none';
  document.getElementById('d_rmonth').style.display = 'none';

  if (checkone==1) document.getElementById('d_rweekday').style.display = '';
  if (checkone==2) document.getElementById('d_rmonth').style.display = '';


}

var ExcludeDate = 0;

function addExclDate() {

  var list = document.getElementById('listexcldate');
  var nOpt = new Option();
  var ndate = document.getElementById('nexcldate').value;

  var jdate = new Date(ndate*1000);
  var y = jdate.getFullYear();
  var m = jdate.getMonth();     // integer, 0..11
  var d = jdate.getDate();
  var ts = calendar.date.print("%s");

  nOpt.id = 'exdate'+ExcludeDate;
  nOpt.value = ndate;
  nOpt.text  = calendar.date.print("%A %d %B %Y");
  i = list.options.length;
  list.options[i] = nOpt;
  ExcludeDate++;
}

function delExclDate() {
  var list = document.getElementById('listexcldate');
  for (i=(list.options.length-1); i>=0; i--) {
    if (list.options[i].selected) list.options[i] = null;
  }
}
</script>

<div id="evrepeatzone" style="display:none">

<fieldset><legend>[TEXT:repeat] : <input id="chkrepeat" type="checkbox" onClick="ViewElement('chkrepeat', 'ifreapeat');" [REPEAT_SELECTED]> 
</legend>
<br>
<div id="ifreapeat" style=" display:none">

<div>

  <div style="width:100%; left:20px;">
   [TEXT:every] : 
    <input onclick="everyInfo()" type="radio" id="repeattype0" name="repeattype" value="0" [REPEATTYPE_0]>[TEXT:day]
    <input onclick="everyInfo()" type="radio" id="repeattype1" name="repeattype" value="1" [REPEATTYPE_1]>[TEXT:week]
    <input onclick="everyInfo()" type="radio" id="repeattype2" name="repeattype" value="2" [REPEATTYPE_2]>[TEXT:month]
    <input onclick="everyInfo()" type="radio" id="repeattype3" name="repeattype" value="3" [REPEATTYPE_3]>[TEXT:year]
   ([TEXT:frequency] <input id="rfrequency" name="rfrequency" size="1" type="text" value="[FREQVALUE]">)
  </div>

<br>

  <div id="d_rweekday" style="left:10%; width:100%; align:center; display:[D_RWEEKDISPLAY]">
   [TEXT:day repetition] : <br>
    <input type="radio" id="rweekday" name="rweekday" value="1" [D_RWEEKDISPLAY_1]>[TEXT:monday]
    <input type="radio" id="rweekday" name="rweekday" value="2" [D_RWEEKDISPLAY_2]>[TEXT:tuesday]
    <input type="radio" id="rweekday" name="rweekday" value="3" [D_RWEEKDISPLAY_3]>[TEXT:wenesday]
    <input type="radio" id="rweekday" name="rweekday" value="4" [D_RWEEKDISPLAY_4]>[TEXT:thurday]
    <input type="radio" id="rweekday" name="rweekday" value="5" [D_RWEEKDISPLAY_5]>[TEXT:friday]
    <input type="radio" id="rweekday" name="rweekday" value="6" [D_RWEEKDISPLAY_6]>[TEXT:saturday]
    <input type="radio" id="rweekday" name="rweekday" value="7" [D_RWEEKDISPLAY_7]>[TEXT:sunday]
    <br>
  </div>

  <div id="d_rmonth" style="left:10%; display:[D_RMONTH]">
   [TEXT:month repetition] : <br>
    <input type="radio" id="rmonth" name="rmonth" value="0" [D_RMONTH_DATE_CHECKED]>[TEXT:per date]
    <input type="radio" id="rmonth" name="rmonth" value="1" [D_RMONTH_DAY_CHECKED]>[TEXT:per day]
    <br>
  </div>

</div>


<div width="100%">

  <br>[TEXT:repeat until] : 
  <input type="radio" id="runtil0" name="runtil" onClick="ViewElement('runtil1', 'vrununtil');" value="0" [D_RUNTIL_0]>[TEXT:forever]
  <input type="radio" id="runtil1" name="runtil" onClick="ViewElement('runtil1', 'vrununtil');" value="1" [D_RUNTIL_1]>[TEXT:this date]&nbsp;:&nbsp;
  <span id="vrununtil" style="display:[RUNUNTIL_DATE_DISPLAY]">
  <input style="cursor:pointer; border: 1px outset [CORE_BGCOLORALTERN]" 
         type="text" value="[uDate]" id="runtildate" 
         name="runtildate" size="8" title="[TEXT:click to change the date]" 
         readonly>  
  <script type="text/javascript">
    Calendar.setup(
      {
        inputField   : "runtildate",        
        ifFormat     : "%d %B %Y",   
        showsTime    : false,
        singleClick  : true,
        button       : "runtildate",
        date         : new Date([umDate]),
        firstDay     : 1
      }
    );
   </script></span>

<hr>

<fieldset><legend>[TEXT:exclude days]</legend>
<select id="listexcldate" name="excldate[]" width="20" size="5" multiple>
[BLOCK EXCLDATE]<option id="exdate[iDate]" value="[mDate]">[rDate]</option>[ENDBLOCK EXCLDATE]
</select>

<img title="[TEXT:add a new day to exclude]" style="cursor:pointer" 
     id="nexcldatebut" name="nexcldatebut" src="RENDEZVOUS/Images/cal-add.gif">
<input onChange="addExclDate();" type="hidden" id="nexcldate" name="nexcldate">
<script type="text/javascript">
Calendar.setup(
    {
        inputField   : "nexcldate",        
        ifFormat     : "%s",   
        showsTime    : false,
        singleClick  : true,
        button       : "nexcldatebut",
        date         : new Date(),
        firstDay     : 1
      }
    );
</script>

<img title="[TEXT:del selected dates]" onClick="delExclDate()" 
     src="RENDEZVOUS/Images/cal-delete.gif">

</fieldset>

</div>

</fieldset>

</div> <!-- end of repeat zone -->



<div id="evattendeeszone" style="display:none">

<fieldset id='vical' class="WGCListRess">
  <legend class="WGCToolTitle">[TEXT:attendees]&nbsp;

  <img id="addattendee" style="cursor:pointer;" 
     onclick="attpicker = subwindow(300, 400, 'CalPicker', '[CORE_STANDURL]&app=WGCAL&action=WGCAL_RESSPICKER_MAIN');" 
     height="15"
     src="WGCAL/Images/ress-modify.gif" title="[TEXT:add attendees]">

   <img id="viewplan" style="cursor:pointer;" onclick="" height="15"
          src="WGCAL/Images/calendar.gif" title="[TEXT:vew disponibility]">

  </legend>

<div id="attlist">
 
<table cellspacing="0" cellpadding="0">
<tbody id="tabress">

<tr style="display:none" id="trsample">
<td> <img style="cursor:pointer;border:1px outset grey" height="8"  
          src="WGCAL/Images/wgcal-suppress.gif" 
          onclick="deleteAttendee('%RID%');" 
          title="[TEXT:delete attendee] %RDESCR%">
</td>
<td>&nbsp;&nbsp;</td>
<td nowrap>
  <span id="%RID%" width="90%">
    <img id="im%RID%" width="20px" height="20px" align="absbottom" src="%RICON%">&nbsp;%RDESCR%
  </span>
</td>
<td>&nbsp;</td>
<td><span id="cp%RID%" name="cp%RID%" style="border:1px inset grey;" 
          title="[TEXT:event state ] %RSTATE%">&nbsp;&nbsp;</span></td>
</tr>
</tbody>
</table>

</div>

</fieldset>
</div>


</div>


<script type="text/javascript">
 ChangeNoHour([NOHOUR]);
 ChangeAllDay([ALLDAY]);
 ChangeAlarm([ALARM]);
window.onunload = attkillwins;
</script>


[ZONE WGCAL:WGCAL_HTMLFOOT]
 
