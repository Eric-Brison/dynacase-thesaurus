[ZONE WGCAL:WGCAL_HTMLHEAD]
<form id="deleteevent" name="deleteevent" method="POST" target="wgcal_calendar" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_DELETEEVENT"> <input type="hidden" id="cev" name="cev" value="[EVENTID]"> </form>

<form id="fgetiuser" target="wgcal_iuser" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_SEARCHIUSER">
<input id="iusertext" name="iusertext" type="hidden">
</form>

<form id="editevent" name="editevent" method="POST" target="wgcal_conflict" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_CHECKCONFLICT">
<input type="hidden" id="cfchecked" name="cfchecked" value="0">
<input type="hidden" id="eventid" name="eventid" value="[EVENTID]">
<input type="hidden" id="ownerid" name="ownerid" value="[ownerid]">
<input type="hidden" id="ownertitle" name="ownertitle" value="[ownertitle]">
<input type="hidden" id="evstatus" name="evstatus" value="[evstatus]">
<input type="hidden" id="evcalendar" name="evcalendar" value="[evcalendar]">
<input type="hidden" id="evconfidentiality" name="evconfidentiality" value="[evconfidentiality]">
<input type="hidden" id="attendees" name="attendees" value="">
<input type="hidden" id="excludedate" name="excludedate" value="">



<fieldset>
<legend>
<img id="butevmainzone" src="WGCAL/Images/wm-rvset.png" class="WGCalZoneSelected"
    height="28" title="[TEXT:set event]" style="border:0px" 
    onClick="SwitchZone('evmainzone'); autoHresize(); autoVresize();" >
<img id="butevrepeatzone" src="WGCAL/Images/wm-repeat.png" class="WGCalZoneDefault"
    height="28"  title="[TEXT:manage repeat]" style="border:0px" 
    onClick="SwitchZone('evrepeatzone'); autoHresize(); autoVresize();" >
</legend>

<!-- Event default view -->
<div  name="_addatt" id="_addatt" style="position:absolute;left:0%;top:0%;width:50%;height:98%;border:2px outset lightgrey;display:none">
<iframe name="wgcal_addatt" id="wgcal_addatt" style="position:absolute;left:0%;top:0%;width:100%;height:100%" marginwidth="0" marginheight="0">
</iframe>
</div>

<div id="evmainzone" style="display:">

<table width="100%" style="margin-top: 0em;" cellspacing="0" border="0">
<tr><td>

<table width="300px" style="margin-top: 0em;" cellspacing="0" border="0">

<tr>

<td colspan="3" style="padding-top:4px; padding-bottom:2em;"><input onfocus="document.getElementById('errTitle').style.display='none'; this.style.background='';" class="Mandatory" id="rvtitle" name="rvtitle" size="40" type="text" title="[TEXT:rv title]" value="[TITLE]" [TITLERO]><div id="errTitle" name="errTitle" style="width:100px; display:none; background-color:white; margin: 2em; padding:1em; border:2px inset red; color:red; position:absolute" onclick="this.style.display='none'">[TEXT:give a title]</div></td>


</tr>

<tr>
<td align="right">[TEXT:start date] : </td>
<td align="center">
<div id="tUstart" name="tUstart" style="display:none; background-color:white; margin: 2em; padding:1em; border:2px inset red; color:red; position:absolute" onclick="this.style.display='none'">[TEXT:start time update according end time]</div>
<span onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''" id="Bstart" style="cursor:pointer;"
      title="[TEXT:click here to enter the start date]">
<img style="display:[DATEBUTVIS]" src="WGCAL/Images/cal-other.gif" height="15" >&nbsp;<span id="Tstart">[STARTREAD]</span></span>
<input type="hidden" value="[START]" id="Dstart" name="Dstart" onChange="ComputeTime('start');">
<input type="hidden" value="[FSTART]" id="Fstart" name="Fstart">
<script type="text/javascript">
  Calendar.setup(
    {
      inputField   : "Dstart",        
      displayArea  : "Tstart",        
      ifFormat     : "%s",   
      daFormat     : "[DFMT]",
      showsTime    : false,
      button       : "Bstart",
      date         : new Date([mSTART]),
      weekNumbers  : false,
      firstDay     : 1
    }
  );
</script>
</td>

<td id="start_hour" align="left" style="visibility:[HVISIBLE]">
<select [DATERO] id="Hstart" name="Hstart" onchange="ComputeTime('start');">[BLOCK SHSEL]<option value="[optvalue]" [optselect]>[optdescr][ENDBLOCK SHSEL]</select>: <select [DATERO] id="Mstart" name="Mstart" onchange="ComputeTime('start');">[BLOCK SHMSEL]<option value="[optvalue]" [optselect]>[optdescr][ENDBLOCK SHMSEL]</select>
</td>

</tr>

<tr>
<td align="right" id="end_hour1" style="visibility:[HVISIBLE]">[TEXT:end date] : </td>
<td align="center" id="end_hour2" style="visibility:[HVISIBLE]">
<div id="tUend" name="tUend" style="display:none; background-color:white; margin: 2em; padding:1em; border:2px inset red; color:red; position:absolute" onclick="this.style.display='none'">[TEXT:end time update according start time]</div>
<span onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''" id="Bend" style="cursor:pointer;"
      title="[TEXT:click here to enter the end date]">
<img style="display:[DATEBUTVIS];" src="WGCAL/Images/cal-other.gif" height="15">&nbsp;<span id="Tend">[ENDREAD]</span></span>
<input type="hidden" value="[END]" id="Dend" name="Dend" onchange="ComputeTime('end');">
<input type="hidden" value="[FEND]" id="Fend" name="Fend">
<script type="text/javascript">
  Calendar.setup(
    {
      inputField   : "Dend",
      displayArea  : "Tend",
      ifFormat     : "%s",
      daFormat     : "[DFMT]",
      showsTime    : false,
      button       : "Bend",
      date         : new Date([mEND]),
      weekNumbers  : false,
      firstDay     : 1
    }
  );
</script>
</td>

<td align="left" id="end_hour3" style="visibility:[HVISIBLE]">
<select [DATERO] id="Hend" name="Hend" onchange="ComputeTime('end');">[BLOCK EHSEL]<option value="[optvalue]" [optselect]>[optdescr][ENDBLOCK EHSEL]</select>: <select [DATERO] id="Mend" name="Mend" onchange="ComputeTime('end');">[BLOCK EHMSEL]<option value="[optvalue]" [optselect]>[optdescr][ENDBLOCK EHMSEL]</select>
</td>
</tr>

<tr>
<td colspan="3" align="center">
<span id="tnohour" style="cursor:pointer; visibility:[NOHOURDISP]"
      onclick="if (clickB('nohour')) ChangeNoHour(false,0);"
      onmouseover="this.style.background='[CORE_BGCOLORALTERN]'"
      onmouseout="this.style.background=''">
<input [NOHOURINIT] [NOHOURRO] id="nohour" style="cursor:pointer;" name="nohour" type="checkbox" onclick="if (clickB('nohour')) ChangeNoHour(false,0);">
[TEXT:no hour]
</span>
<span id="tallday" style="cursor:pointer; visibility:[ALLDAYDISP]" 
      onclick="if (clickB('allday')) ChangeAllDay(false,0);" 
      onmouseover="this.style.background='[CORE_BGCOLORALTERN]'"
      onmouseout="this.style.background=''">
<input [ALLDAYINIT] [ALLDAYRO] id="allday" style="cursor:pointer;" name="allday" type="checkbox" onclick="if (clickB('allday')) ChangeAllDay(false,0);"></input>
[TEXT:all the day]
</span>
</td>
</tr>

<tr>
<td colspan="3">[TEXT:rv note]<br><textarea cols="40" rows="3" id="rvnote" name="rvnote" [DESCRRO]>[DESCR]</textarea></td>
</tr>

<tr>
<td  align="right">[TEXT:confidentiality]&nbsp;:&nbsp;</td>
<td colspan="2"><select id="rvconfid" onchange="SetSelectedItem('rvconfid', 'evconfidentiality')" [rvvisro]>[BLOCK RVCONFID]<option value="[value]" [selected]>[descr][ENDBLOCK RVCONFID]</select>
</td>
</tr>

<tr>
<td align="right">[TEXT:calendar]&nbsp;:&nbsp;</td>
<td colspan="2" ><select id="rvcalendar" name="rvcalendar" onchange="SetSelectedItem('rvcalendar', 'evcalendar');" [rvcalro]>[BLOCK CALS]<option value="[value]" [selected]>[descr][ENDBLOCK CALS]</select>
</td>
</tr>

<tr>
<td align="right"><span style="cursor:pointer" onclick="ChangeAlarm()" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''">[TEXT:alarm]&nbsp;<input id="AlarmCheck" name="AlarmCheck" type="checkbox" style="cursor:pointer" onClick="ChangeAlarm()" [ALARMCHK] [ALARMRO]></span>&nbsp;&nbsp;</td>
<td colspan="2" >
<span id="AlarmVis" style="visibility:[ALRMVIS]">
<select id="alarmhour" name="alarmhour" [ALARMRO]>[BLOCK ALARM_HR]
<option value="[ALRMPERIOD_V]" [ALRMPERIOD_S]>[ALRMPERIOD_V][ENDBLOCK ALARM_HR]
</select>h&nbsp; <select id="alarmmin" name="alarmmin" [ALARMRO]>[BLOCK ALARM_MIN]
<option value="[ALRMPERIOD_V]" [ALRMPERIOD_S]>[ALRMPERIOD_V][ENDBLOCK ALARM_MIN]
</select>mn&nbsp;[TEXT:before]
</span>
</td>
</tr>

</table>

</td>
<td valign="top">

<div id="evattendeeszone" style="display:">

<fieldset id='vical'>
  <legend class="WGCToolTitle">
  [TEXT:attendees]&nbsp;

  <img id="addattendee" style="display:[attendeesro]; cursor:pointer;" 
     onclick="ViewRessourceHelper('_addatt', '[CORE_STANDURL]&app=WGCAL&action=WGCAL_RESSPICKER_MAIN'); " 
     height="20"
     src="WGCAL/Images/wm-attendees.png" title="[TEXT:add attendees]">

   <img id="viewplan" style="display:[voneatt]; cursor:pointer;" height="20"
          onclick="viewattdispo('[CORE_STANDURL]app=FDL&action=FDL_CARD&zone=FREEEVENT:PLANNER:T?idfamref=[idfamref]&byres=Y&id=[planid]');";
          src="WGCAL/Images/wm-planner.png" title="[TEXT:vew disponibility]">

   <img id="delall" style="display:[voneatt]; cursor:pointer;" height="20"
          onclick="ok=confirm('[TEXT:confirm delete all attendees]'); if (ok) deleteAttendee(-1);";
          src="WGCAL/Images/wm-delete.png" title="[TEXT:delete all attendees]">

  </legend>

<div id="errAtt" name="errAtt" style="width:100px; display:none; background-color:white; margin: 2em; padding:1em; border:2px inset red; color:red; position:absolute" onclick="this.style.display='none'">[TEXT:one ressource or you in event]</div>

<table id="vnatt" cellspacing="0" cellpadding="0" width="100%"><tr>
<td>
<input id="stmptext" type="text" size="15"></input>
<img id="stmpbutton" style="cursor:pointer;" onclick="SearchIUser(document.getElementById('stmptext').value)" height="10" src="WGCAL/Images/wm-searchiuser.png" title="[TEXT:search]">
</td>
<td align="right">
<span style="display:[vnatt]; align:right; cursor:pointer;" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''" onclick="ShowHideStatus();" title="[TEXT:I participe to this meeting]">[TEXT:I participe to this meeting]<input id="withMe" name="withMe" type="checkbox" style="cursor:pointer;" onclick="ShowHideStatus();" [WITHME] [WITHMERO]></span>
</td>
</td></table>


<div style="border: 1px inset lightgrey;" id="attlist">
 
<table cellspacing="0" cellpadding="0" align="center" width="80%">
<tbody id="tabress">

<tr style="display:none" id="trsample">
<td> <img style="display:[attendeesro];cursor:pointer;border:1px outset grey" height="12"  
          onmouseover="this.style.border='1px inset grey'" onmouseout="this.style.border='1px outset grey'"
          src="WGCAL/Images/wm-delete.png" onclick="deleteAttendee('%RID%');" title="[TEXT:delete attendee] %RDESCR%">
</td>
<td>&nbsp;</td>
<td><span id="cp%RID%" name="cp%RID%" style="cursor:crosshair; border:1px inset grey;" title="">&nbsp;&nbsp;</span>&nbsp;
  <span style="cursor:pointer" id="%RID%" width="90%" title="%RDESCR%"
    onmouseover="ViewGroup(this,true);"  onmouseout="ViewGroup(this,false);"
    onclick="RessourceSelect(%RID%);">
    <img id="im%RID%" width="20px" height="20px" align="absbottom" src="%RICON%">&nbsp;%RDESCR%
  </span>
</td>
</tr>

</tbody>
</table>

</div>


<script type="text/javascript">
var DisplayedRess = new Array();[BLOCK DRESS]
DisplayedRess[[idress]] = new Array( [ressid], '[resstitle]', '[ressico]');[ENDBLOCK DRESS]
var PreferedRess = new Array( );[BLOCK PRESS]
PreferedRess[[idress]] = new Array( [ressid], '[resstitle]', '[ressico]');[ENDBLOCK PRESS]
</script>

<table width="100%" cellspacing="0" cellpadding="0">
<tr><td align="right">

<span id="press" style="cursor:pointer;" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''" onclick="ImportRessources('press', PreferedRess);" title="[TEXT:use my prefered ressources]">[TEXT:use my prefered ressource]<input id="bpress" name="bpress" type="checkbox" style="cursor:pointer;" onclick="ImportRessources('press', PreferedRess);" [idpressst]></span>
</td></tr>
<tr><td align="right">

<span id="dress" style="cursor:pointer;" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''" onclick="ImportRessources('dress', DisplayedRess);" title="[TEXT:use displayed ressources]">[TEXT:use displayed ressources]<input id="bdress" name="bdress" type="checkbox" style="cursor:pointer;" onclick="ImportRessources('dress', DisplayedRess);" [iddressst]></span>

</td></tr>
</table>



</fieldset>
</div>

</td></tr></table>



</div>


<!-- Repeat zone -->

<div id="evrepeatzone" style="display:none">


<div>

  <div style="width:100%; left:20px;">
   [TEXT:every] : 
<span onclick="if (clickB('repeattype0')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype0')) everyInfo()" type="radio" id="repeattype0" name="repeattype" value="0" [repeatdis] [REPEATTYPE_0]>[TEXT:none]</span>
<span onclick="if (clickB('repeattype1')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype1')) everyInfo()" type="radio" id="repeattype1" name="repeattype" value="1" [repeatdis] [REPEATTYPE_1]>[TEXT:day]</span>
<span onclick="if (clickB('repeattype2')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype2')) everyInfo()" type="radio" id="repeattype2" name="repeattype" value="2" [repeatdis] [REPEATTYPE_2]>[TEXT:week]</span>
<span onclick="if (clickB('repeattype3')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype3')) everyInfo()" type="radio" id="repeattype3" name="repeattype" value="3" [repeatdis] [REPEATTYPE_3]>[TEXT:month]</span>
<span onclick="if (clickB('repeattype4')) everyInfo();" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="if (clickB('repeattype4')) everyInfo()" type="radio" id="repeattype4" name="repeattype" value="4" [repeatdis] [REPEATTYPE_4]>[TEXT:year]</span>
   ([TEXT:frequency] <input id="rfrequency" name="rfrequency" size="1" type="text" value="[FREQVALUE]" [repeatdis]>)
  </div>

<br>

  <div id="d_rweekday" style="left:10%; width:100%; align:center; display:[RWEEKDISPLAY]">
   [TEXT:day repetition] : <br>
[BLOCK D_RWEEKDISPLAY]<span onclick="clickB('rweekday[dayn]')" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="clickB('rweekday[dayn]')" type="checkbox" id="rweekday[dayn]" name="rweekday[]" value="[dayn]" [rdstate] [repeatdis]>[tDay]</span>[ENDBLOCK D_RWEEKDISPLAY]
  </div>

  <div id="d_rmonth" style="left:10%; display:[D_RMONTH]">
   [TEXT:month repetition] : <br>
    <span onclick="clickB('rmonth0')" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="clickB('rmonth0')"  type="radio" id="rmonth0" name="rmonth" value="0" [repeatdis] [D_RMONTH_DATE_CHECKED]>[TEXT:per date]</span>
    <span onclick="clickB('rmonth1')" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input onclick="clickB('rmonth1')"  type="radio" id="rmonth1" name="rmonth" value="1" [repeatdis] [D_RMONTH_DAY_CHECKED]>[TEXT:per day]</span>
    <br>
  </div>

</div>


<div width="100%">

  <br>[TEXT:repeat until] : 
  <span onclick="if (clickB('runtil')) ViewElement('runtild', 'runtildatebutton');" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input type="radio" id="runtil" name="runtil" onClick="if (clickB('runtil')) ViewElement('runtild', 'runtildatebutton');"
         value="0" [D_RUNTIL_INFI] [repeatdis]>[TEXT:forever]</span>
  <span onclick="if (clickB('runtild')) ViewElement('runtild', 'runtildatebutton');" style="cursor:pointer" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"><input type="radio" id="runtild" name="runtil" onClick="if (clickB('runtild')) ViewElement('runtild', 'runtildatebutton');" 
         value="1" [D_RUNTIL_DATE] [repeatdis]>[TEXT:this date]</span>&nbsp;:&nbsp;

 <span id="runtildatebutton" name="runtildatebutton" style="display:[RUNUNTIL_DATE_DISPLAY]; cursor:pointer" title="[TEXT:click to select a date]" onmouseover="this.style.background='[CORE_BGCOLORALTERN]'" onmouseout="this.style.background=''"> 
 <img style="display:[repeatvie]; cursor:pointer" title="[TEXT:click to select a date]"  height="15" src="WGCAL/Images/cal-other.gif">

 <input type="hidden" id="Vruntildate" name="Vruntildate" value="[Vruntildate]">
 <span id="runtildate">[uDate]</span>
 <script type="text/javascript">
    Calendar.setup(
      {
        inputField   : "Vruntildate",        
        displayArea  : "runtildate",        
        ifFormat     : "%s",   
        daFormat     : "[DFMT]",
        showsTime    : false,
        button       : "runtildatebutton",
        date         : new Date([umDate]),
        weekNumbers  : false,
        firstDay     : 1
      }
    );
   </script></span>

<hr>

<fieldset><legend>[TEXT:exclude days]</legend>

<span style="display:[repeatvie]">
<img id="nexcldatebut" name="nexcldatebut"
     title="[TEXT:add a new day to exclude]" style="cursor:pointer" 
     height="12" src="WGCAL/Images/wgcal-plus.gif">
<br>
<img title="[TEXT:del selected dates]" onClick="delExclDate()" 
     height="12" src="WGCAL/Images/wgcal-minus.gif">
</span>

<span>
<select id="listexcldate" name="listexcldate[]" width="20" size="5" multiple>
[BLOCK EXCLDATE]<option id="exdate[iDate]" value="[mDate]">[rDate]</option>[ENDBLOCK EXCLDATE]
</select>
</span>

<input onChange="addExclDate();" type="hidden" id="nexcldate" >
<script type="text/javascript">
Calendar.setup(
    {
        inputField   : "nexcldate",        
        ifFormat     : "%s",   
        showsTime    : false,
        button       : "nexcldatebut",
        date         : new Date(),
        weekNumbers  : false,
        firstDay     : 1
      }
    );
</script>
</fieldset>

</div>

</div> <!-- end of repeat zone -->

</fieldset>

<table width="100%" style="margin-top: 0em;">
<tr>
<td align="left">
[BLOCK EMPTY][nop]&nbsp;&nbsp;
<a href="mailto:[mailadd]"><img src="WGCAL/Images/wm-mail.png" 
  height="20" title="[TEXT:mail to contacts]" class="WGCalAction" style="border:0px"></a>
<img src="WGCAL/Images/wm-print.png" 
  height="20" title="[TEXT:print]" class="WGCalAction" onclick="window.print();">
<img src="WGCAL/Images/wm-delete.png" 
  height="20" title="[TEXT:delete]" class="WGCalAction" onclick="deleteEvent('[TEXT: delete this event]');">
[ENDBLOCK EMPTY]
</td>
<td align="right">
<img src="WGCAL/Images/wm-save.png" id="btnSave"
  height="20" title="[TEXT:save]" class="WGCalAction" onclick="saveEvent();">
<img src="WGCAL/Images/wm-close.png" id="btnCancel"
  height="20" title="[TEXT:cancel]" class="WGCalAction" onclick="cancelEvent('[TEXT: cancel modifications]');">
</td></tr></table>


<script type="text/javascript">
SetModeRo([ROMode]);
SetRessDeco('WGCRessSelected', 'WGCRessDefault');
[BLOCK ADD_RESS] addRessource([attId], '[attTitle]', '[attIcon]',  '[attState]', '[attLabel]', '[attColor]', [attSelect]);
[ENDBLOCK ADD_RESS] 
//window.onunload = cancelEvent;
document.getElementById('rvtitle').focus();
</script>

</form>

[BLOCK GROUPS]
<div id="grp[RID]" style="display:none;" class="wEvBack"><div class="wMonthTextTitle"><img width="20px" height="20px" align="absbottom" src="[groupicon]"> [grouptitle]</div>[BLOCK [GROUPCONTENT]]
<div><img height="15" src="[atticon]"><span style="text-decoration:[attnamestyle]">[atttitle]</span>&nbsp;<span style="font-style:italic">([attstate])</span></div>[ENDBLOCK [GROUPCONTENT]]
</div>[ENDBLOCK GROUPS]

<iframe name="wgcal_conflict" id="wgcal_conflict" style="position:absolute;left:1%;top:1%;width:98%;height:98%;border:1px dotted red;display:none" marginwidth="0" marginheight="0">
</iframe>

<iframe name="wgcal_iuser" id="wgcal_iuser" style="display:none"></iframe>

[ZONE WGCAL:WGCAL_HTMLFOOT]
 
