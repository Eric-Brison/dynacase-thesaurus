[ZONE WGCAL:WGCAL_HTMLHEAD]
<div id="toolbarmain style="display:none">
<form id="eventstate" target="wgcal_toolbar" name="feventstate" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_SETEVENTSTATE">
     <input id="cev" name="cev" type="hidden" value="-1">
     <input id="st" name="st" type="hidden" value="-1">
     <input id="st" name="ra" type="hidden" value="WGCAL_TOOLBAR">
</form>
<form id="f_initress" target="wgcal_toolbar" name="initress" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_INITRESSOURCES"></form>

<form id="ftoolsvis" target="wgcal_hidden" name="ftoolsvis" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_SETTOOLSTATE">
<input id="toolsvis" name="toolsvis" type="hidden" value=""></form>

<form id="updatecal" target="wgcal_calendar" name="fupdatecal" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_CALENDAR"></form>
</div>
<div title="[TEXT:click here to refresh toolbar]" onclick="document.location.reload(true)" class="wWhoAmI">
<table cellspacing="0">
<tr><td><img src="[IMG:wm-reloadsync.gif]" height="25"><td><span style="font-weight:bold">[owner], [today]</span>[IF LSYNC]<span style="[lsyncstyle];font-size:90%"> ([TEXT:last sync] [lastsync])</span>[ENDIF LSYNC]</td></tr>
</table>
</div>

<!-- Rendez-vous en attente -->
<!-- POPUP DIVISION -->
<script type="text/javascript"> 
var CEventTime = 0;
var CEventId = -1;
var CEventText = '';
</script>
<div  style="display:none" id="waitpopup" class="wgcalpopup">
<a href="#" id="viewevent" onclick="ViewEvent('[CORE_STANDURL]',CEventId); closeMenu('waitpopup')">[IF POPUPICONS]<img style="border:0px" src="[IMG:wm-evview.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:view this]</a>
<a class="separator"></a>
<a href="#" id="acceptevent" onclick="ok=confirm('[TEXT:accept event] '+CEventText+' ?'); if (ok) SetEventState(CEventId, 2); closeMenu('waitpopup')">[IF POPUPICONS]<img style="border:0px" src="[IMG:wm-evaccept.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:accept this]</a>
<a href="#" id="refuseevent" onclick="ok=confirm('[TEXT:refuse event] '+CEventText+' ?'); if (ok) SetEventState(CEventId, 3); closeMenu('waitpopup')">[IF POPUPICONS]<img style="border:0px" src="[IMG:wm-evrefuse.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:reject this]</a>
<a class="separator"></a>
<a href="#" id="gotoperiod" onclick="loadPeriod('[CORE_STANDURL]', CEventTime); closeMenu('waitpopup')">[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-evdate.gif" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:goto this period]</a>
<a class="separator"></a>
<a href="#" id="cancelevent" onclick="closeMenu('waitpopup')"  >[IF POPUPICONS]<img style="border:0px" src="[IMG:wm-closepopup.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:close menu]</a>
</div> <!-- end POPUP DIVISION -->

<table class="wToolButton" onmouseover="this.className='wToolButtonOver'" onmouseout="this.className='wToolButton'" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td onclick="WGCalChangeVisibility('waitrv');" align="left">[TEXT:waiting rv] ([RVCOUNT])</td>
<td align="right"><input type="checkbox" id="alertwrv" name="alertwrv" onchange="setwrvalert()" [alertwrv] title="[TEXT:alert for new event ?]"></td>
</tr>
</table>

<div id='waitrv' class="wToolArea" style="height:[zonealertsize]px; overflow:auto; display:[vwaitrv]">
[BLOCK WAITRV]
<div id="evt[wrvid]" class="WGCwrvdefault" style="cursor:crosshair; border-left:5px solid [wrvcolor]" 
     onmouseover="this.className = 'WGCwrvover'; " 
     onmouseout="this.className = 'WGCwrvdefault'"
     onContextMenu="CEventTime=[tsdate]; CEventId=[wrvid]; CEventText='[wrvtitle]'; openMenu(event,'waitpopup',[waitrg]);return false" 
     onclick="CEventId=[wrvid]; CEventText='[wrvtitle]';ViewEvent('[CORE_STANDURL]',[wrvid]);" >&nbsp;<img id="iwaitrv" src="[wrvicon]" height="15">[wrvtitle]</div>[ENDBLOCK WAITRV]
</div>
 
<!-- NAVIGATOR  -->
<table class="wToolButton" onmouseover="this.className='wToolButtonOver'" onmouseout="this.className='wToolButton'"    width="100%" cellspacing="0" cellpadding="0">
<tr>
<td onclick="WGCalChangeVisibility('inav');" align="left">[TEXT:date selector]</td>
<td align="right"><input id="chk2cal" type="checkbox" onclick="v=(this.checked?'':'none'); document.getElementById('cal2').style.display=v;" title="[TEXT:display two months]"></td>
</tr>
</table>
<div align="center" class="wToolArea" width="100%" id="inav" style="overflow:auto; display:[vinav]">
<script type="text/javascript">Calendar.setup({
        ifFormat       :    '%s',       // format of the input field
        showsTime      :    false,            // will display a time selector
        singleClick    :    false,           // double-click mode
        firstDay       :    1,
        date           :    new Date([CmTIME]),
        weekNumbers    :    true,
        flat           :    'inav',
        range          :    [ [YSTART] , [YSTOP] ],
        flatCallback   :    WGCalSetDate,
        step           :    1              
    });</script><div align="center" width=100%" id="cal2" style="display:none"><script type="text/javascript">Calendar.setup({
        ifFormat       :    '%s',       // format of the input field
        showsTime      :    false,            // will display a time selector
        singleClick    :    false,           // double-click mode
        firstDay       :    1,
        date           :    new Date([Cm2TIME]),
        weekNumbers    :    true,
        flat           :    'cal2',
        range          :    [ [YSTART] , [YSTOP] ],
        flatCallback   :    WGCalSetDate,
        step           :    1              
    });</script></div>
</div>

<!-- LISTE DES AGENDAS -->

<table class="wToolButton" onmouseover="this.className='wToolButtonOver'" onmouseout="this.className='wToolButton'" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td onclick="WGCalChangeVisibility('vvical');" align="left">[TEXT:calendar selector]</td>
<td align="right">
<img id="resssel" style="cursor:pointer;" onclick="picker = subwindow(300, 400, 'CalPicker', '[CORE_STANDURL]&app=WGCAL&action=WGCAL_RESSPICKER_MAIN&updt=memoress');" height="15" src="[IMG:wm-attendees.gif]" title="[TEXT:modify the list]">
<img id="resssel" style="cursor:pointer;" onclick="document.getElementById('updatecal').submit();" height="15" src="[IMG:wm-refreshcal.gif]" title="[TEXT:update calendar]">
</td>
</tr>
</table>


<!-- POPUP DIVISION -->

<div  style="display:none" id="resspopup" class="wgcalpopup">
<a href="#" id="displayress" onclick="vuvRessource(); closeMenu('resspopup')">[IF POPUPICONS]
<img style="border:0px" src="[IMG:wm-ressshowhide.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:show/hide this ressource]</a>
<a href="#" id="changeresscolor" onclick="showColorPicker(event, CRessId); closeMenu('resspopup')">[IF POPUPICONS]
<img style="border:0px" src="[IMG:wm-resscolor.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:change color for this ressource]</a>
<a href="#" id="removeress" onclick="removeRessource(CRessId); closeMenu('resspopup')">[IF POPUPICONS]
<img style="border:0px" src="[IMG:wm-ressdelete.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:remove this ressource]</a>
<a class="separator"></a>
<a href="#" id="onlyme" onclick="showHideAllRess(CRessId); closeMenu('resspopup')">[IF POPUPICONS]
<img style="border:0px" src="[IMG:wm-onlyme.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:display only this]</a>
<a href="#" id="invertress" onclick="showHideAllRess(-2); closeMenu('resspopup')">[IF POPUPICONS]
<img style="border:0px" src="[IMG:wm-ressinvert.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:invert selection]</a>
<a href="#" id="displayallr" onclick="showHideAllRess(0); closeMenu('resspopup')">[IF POPUPICONS]
<img style="border:0px" src="[IMG:wm-ressdisplayall.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:display all ressources]</a>
<a href="#" id="hideallr" onclick="showHideAllRess(-1); closeMenu('resspopup')">[IF POPUPICONS]
<img style="border:0px" src="[IMG:wm-resshideall.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:hide all ressources]</a>
<a class="separator"></a>
<a href="#" id="cancelress" onclick="closeMenu('resspopup')">[IF POPUPICONS]
<img style="border:0px" src="[IMG:wm-closepopup.gif]" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:close menu]</a>
</div> <!-- end POPUP DIVISION -->

<div id="vvical" style="display:[vvvical]" width="100%" class="wToolArea" >
<table width="100%" cellspacing="0" cellpadding="0">
<thead></thead>
<tbody id="tabress">

<tr style="display:none; border:0px;" id="trsample">
<td width="6px" id="cp%RID%" style="border: 1px outset">&nbsp;</td>
<td nowrap id="%RID%" style="cursor:crosshair" 
    onmouseover="if (this.className=='WGCRessSelected') return; this.className='WGCRessOver'" 
    onmouseout="if (this.className=='WGCRessSelected') return; this.className='WGCRessDefault'"
    onclick="CRessId=this.id; vuvRessource();"
    onContextMenu="CRessId=this.id; openMenu(event,'resspopup', CRessId); return false">
&nbsp;<img id="im%RID%" height="15px" align="absbottom" src="%RICON%">&nbsp;%RDESCR%
</td>
</tr>
</tbody>

<tfoot>
<tr><td colspan="2"></td></tr>
<tr>
</tfoot>
</table>
</div>

<!-- search zone -->
[IF SHOWSEARCH] [ZONE WGCAL:SEARCH] [ENDIF SHOWSEARCH]


<!-- todo zone -->
[IF SHOWTODOS] [ZONE WGCAL:TODO?dtodo=[tododays]] [ENDIF SHOWTODOS]

[IF SHOWCONTACTS] [ZONE WGCAL:CONTACTS] [ENDIF SHOWCONTACTS]


<script type="text/javascript">

var  toolList = new Array( 'inav', 'vvical', 'waitrv', 'todo' [IF SHOWCONTACTS],'contacts'[ENDIF SHOWCONTACTS]);

[BLOCK L_RESS]
InsertRessource('[RDESCR]', '[RID]', '[RICON]', '[RCOLOR]', '[RSTYLE]', '[RSTATE]');[ENDBLOCK L_RESS]
var MyFreedomId = [MyFreedomId];
saveRessources();

</script>



[ZONE WGCAL:WGCAL_HTMLFOOT]
