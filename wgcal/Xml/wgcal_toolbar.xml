[ZONE WGCAL:WGCAL_HTMLHEAD]
<div style="display:none">
<form id="eventstate" target="wgcal_calendar" name="feventstate" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_SETEVENTSTATE">
     <input id="cev" name="cev" type="hidden" value="-1">
     <input id="st" name="st" type="hidden" value="-1">
</form>
<form id="f_initress" target="wgcal_toolbar" name="initress" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_INITRESSOURCES"></form>

<form id="ftoolsvis" target="wgcal_hidden" name="ftoolsvis" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_SETTOOLSTATE">
<input id="toolsvis" name="toolsvis" type="hidden" value=""></form>

<form id="updatecal" target="wgcal_calendar" name="fupdatecal" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_CALENDAR"></form>
</div>
<div title="[TEXT:click here to refresh toolbar]" onclick="document.location.reload(true)" class="wWhoAmI">[owner], [today]</div>
<br>

<!-- search zone -->
[ZONE WGCAL:SEARCH]

<!-- Rendez-vous en attente -->
<!-- POPUP DIVISION -->
<script type="text/javascript"> 
var CEventId = -1;
var CEventText = '';
</script>
<div  style="display:none" id="waitpopup" class="wgcalpopup">
<a href="#" id="viewevent" onclick="ViewEvent('[CORE_STANDURL]',CEventId); closeMenu('waitpopup')">[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-evview.png" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:view this]</a>
<a class="separator"></a>
<a href="#" id="acceptevent" onclick="ok=confirm('[TEXT:accept event] '+CEventText+' ?'); if (ok) SetEventState(CEventId, 2); closeMenu('waitpopup')">[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-evaccept.png" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:accept this]</a>
<a href="#" id="refuseevent" onclick="ok=confirm('[TEXT:refuse event] '+CEventText+' ?'); if (ok) SetEventState(CEventId, 3); closeMenu('waitpopup')">[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-evrefuse.png" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:reject this]</a>
<a class="separator"></a>
<a href="#" id="cancelevent" onclick="closeMenu('waitpopup')"  >[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-closepopup.png" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:close menu]</a>
</div> <!-- end POPUP DIVISION -->

<table class="wToolButton" onmouseover="this.className='wToolButtonOver'" onmouseout="this.className='wToolButton'" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td onclick="WGCalChangeVisibility('waitrv');" align="left">[TEXT:waiting rv] ([RVCOUNT])</td>
<td align="right"><input type="checkbox" id="alertwrv" name="alertwrv" onchange="setwrvalert()" [alertwrv] title="[TEXT:alert for new event ?]"></td>
</tr>
</table>

<div id='waitrv' class="wToolArea" style="height:[zonealertsize]px; overflow:auto; display:[vwaitrv]">
[BLOCK WAITRV]
<div id="evt[wrvid]" class="WGCwrvdefault" style="border-left:5px solid [wrvcolor]" 
     onmouseover="this.className = 'WGCwrvover'; " 
     onmouseout="this.className = 'WGCwrvdefault'"
     onContextMenu="CEventId=[wrvid]; CEventText='[wrvtitle]'; openMenu(event,'waitpopup',[waitrg]);return false" 
     onclick="CEventId=[wrvid]; CEventText='[wrvtitle]';ViewEvent('[CORE_STANDURL]',[wrvid]);" >&nbsp;<img id="iwaitrv" src="[wrvicon]" height="15">[wrvtitle]</div>[ENDBLOCK WAITRV]
</div>
 
<!-- [ ZONE WGCAL:WGCAL_NAVIGATOR ]  -->
<table class="wToolButton" onmouseover="this.className='wToolButtonOver'" onmouseout="this.className='wToolButton'"    width="100%" cellspacing="0" cellpadding="0">
<tr>
<td onclick="WGCalChangeVisibility('inav');" align="left">[TEXT:date selector]</td>
<td align="right"><input type="checkbox" onchange="v=(this.checked?'':'none'); document.getElementById('cal2').style.display=v" title="[TEXT:display two months]"></td>
</tr>
</table>
<div align="center" class="wToolArea" width="100%" id="inav" style="overflow:auto; display:[vinav]">
<script type="text/javascript">Calendar.setup({
        ifFormat       :    '%s',       // format of the input field
        showsTime      :    false,            // will display a time selector
        singleClick    :    false,           // double-click mode
        firstDay       :    1,
        date           :    new Date([CmTIME]),
        weekNumbers    :    true,
        flat           :    'inav',
        range          :    [ [YSTART] , [YSTOP] ],
        flatCallback   :    WGCalSetDate,
        step           :    1              
    });</script><div align="center" width=100%" id="cal2" style="display:none"><script type="text/javascript">Calendar.setup({
        ifFormat       :    '%s',       // format of the input field
        showsTime      :    false,            // will display a time selector
        singleClick    :    false,           // double-click mode
        firstDay       :    1,
        date           :    new Date([Cm2TIME]),
        weekNumbers    :    true,
        flat           :    'cal2',
        range          :    [ [YSTART] , [YSTOP] ],
        flatCallback   :    WGCalSetDate,
        step           :    1              
    });</script></div>
</div>

<!-- [ ZONE WGCAL:WGCAL_LISTRESS ] -->
<script type="text/javascript"> 
var CRessId = -1;
var CRessText = '';
</script>
<div  style="display:none" id="resspopup" class="wgcalpopup">
<a href="#" id="displayress" onclick="; closeMenu('resspopup')">[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-evview.png" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:display this]</a>
<a href="#" id="hideress" onclick="; closeMenu('resspopup')">[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-evview.png" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:hide this]</a>
<a href="#" id="colorress" onclick="; closeMenu('resspopup')">[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-evview.png" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:change color]</a>
<a href="#" id="deleteress" onclick="; closeMenu('resspopup')">[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-evview.png" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:delete this]</a>
<a class="separator"></a>
<a href="#" id="cancelevent" onclick="closeMenu('waitpopup')"  >[IF POPUPICONS]<img style="border:0px" src="WGCAL/Images/wm-closepopup.png" height="12px">&nbsp;[ENDIF POPUPICONS][TEXT:close menu]</a>
</div> <!-- end POPUP DIVISION -->

<table class="wToolButton" onmouseover="this.className='wToolButtonOver'" onmouseout="this.className='wToolButton'" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td onclick="WGCalChangeVisibility('vvical');" align="left">[TEXT:calendar selector]</td>
<td align="right">
<img id="resssel" style="cursor:pointer;" onclick="picker = subwindow(300, 400, 'CalPicker', '[CORE_STANDURL]&app=WGCAL&action=WGCAL_RESSPICKER_MAIN&updt=memoress');" height="15" src="WGCAL/Images/wm-attendees.png" title="[TEXT:modify the list]">
<img id="resssel" style="cursor:pointer;" onclick="document.getElementById('updatecal').submit();" height="15" src="WGCAL/Images/wm-refreshcal.gif" title="[TEXT:update calendar]">
</td>
</tr>
</table>


<div id="vvical" style="display:[vvvical]" width="100%" class="wToolArea" >
<table width="100%" cellspacing="0" cellpadding="0">
<thead></thead>
<tbody id="tabress">

<tr style="border:0px;" id="trressme">
<td width="10px" id="cp[myrid]" style="cursor:pointer; border: 1px outset"
    onClick="showColorPicker(event, 'cp[myrid]', [myrid]);" title="[TEXT:change my event color]">&nbsp;</td>
<td nowrap id="[myrid]"  
    onclick="setRessourceState('[myrid]', 'WGCRessSelected', 'WGCRessDefault', 1);"
    onmouseover="WGCalChangeClass(event, '[myrid]', 'WGCRessSelected', 'WGCRessOver');" 
    onmouseout="WGCalChangeClass(event, '[myrid]', 'WGCRessSelected', 'WGCRessDefault');">
&nbsp;<img id="im[myrid]" height="15px" align="absbottom" src="[myricon]">&nbsp;[myrdesc]
</td>
</tr>

<tr style="display:none; border:0px;" id="trsample">
<td width="6px" id="cp%RID%" style="cursor:pointer; border: 1px outset"
    onClick="showColorPicker(event, this.id, %RID%);" title="[TEXT:change my event color]">&nbsp;</td>
<td nowrap id="%RID%" 
    onclick="setRessourceState('%RID%', 'WGCRessSelected', 'WGCRessDefault', 1);"
    onContextMenu="CRessId=this.id; openMenu(event,'resspopup', %RGRESS%); return false" 
    onmouseover="WGCalChangeClass(event, '%RID%', 'WGCRessSelected', 'WGCRessOver');" 
    onmouseout="WGCalChangeClass(event, '%RID%', 'WGCRessSelected', 'WGCRessDefault');">
&nbsp;<img id="im%RID%" height="15px" align="absbottom" src="%RICON%">&nbsp;%RDESCR%
</td>
</tr>
</tbody>

<tfoot>
<tr><td colspan="2"></td></tr>
<tr>
<td colspan="2" align="right">
<!-- img id="ressres" style="cursor:pointer;" onclick="getElementById('f_initress').submit();" height="15" src="WGCAL/Images/wgcal-reset.gif" title="[TEXT:reinit the list]"-->&nbsp;<img id="resssav" style="cursor:pointer;" onclick="saveRessources(); alert('[TEXT: ressource list saved]');" height="15" src="WGCAL/Images/ress-save.gif" title="[TEXT:save the list]">
</td>
</tfoot>
</table>
</div>

[ZONE WGCAL:TODO?dtodo=[tododays]]

<script type="text/javascript">

var  toolList = new Array( 'inav', 'vvical', 'waitrv', 'todo');

storeRessource('[myrid]', '[myrcolor]', '1', '[myricon]', '[myrdesc]', 'WGCRessSelected');
[BLOCK L_RESS]
InsertRessource('[RDESCR]', '[RID]', '[RICON]', '[RCOLOR]', '[RSTYLE]', '[RSTATE]');[ENDBLOCK L_RESS]
</script>



[ZONE WGCAL:WGCAL_HTMLFOOT]
