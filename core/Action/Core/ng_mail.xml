<div class="rubrique" width="100%">
<script language="JavaScript">

function SendMboxRequest(idmbx) {

  var url = '[CORE_SSTANDURL]&sole=Y&app=CORE&action=NG_MAILCHECK&acc='+idmbx;

  document.getElementById("r"+idmbx).innerHTML = document.getElementById('waiting').innerHTML;
  OpenMbox(idmbx);
  if (window.XMLHttpRequest) req = new XMLHttpRequest();
    else if (window.ActiveXObject) {
      isIE = true;
      req = new ActiveXObject("Microsoft.XMLHTTP");
    }	
    if (req) {
//       req.onreadystatechange = ReceiveReqChange;
// pour gérer lde multiples requete simultanee
      req.onload = function(event) {
	var self = event.target;
	document.getElementById("r"+idmbx).innerHTML = '';
	document.getElementById("z"+self.userdata).innerHTML = self.responseText;
      }
      req.open("GET", url, true);
      req.overrideMimeType('text/xml');
      req.userdata = idmbx;
      req.send(null);
    }
}

function ShowHideMbox(id) {
  var mbo = document.getElementById('r'+id);
  var mbog = document.getElementById('g'+id);
  if (!mbo) return;
  if (mbo.style.display=='') CloseMbox(id);
  else OpenMbox(id);
}

function CloseMbox(id) {
  var mbo = document.getElementById('r'+id);
  var mbog = document.getElementById('g'+id);
  if (!mbo || !mbog) return;
  if (mbo.style.display!='none') {
    mbo.style.display = 'none';
    mbog.src = '[IMG:nb_mbox_open.png]';
  }
}

function OpenMbox(id) {
  var mbo = document.getElementById('r'+id);
  var mbog = document.getElementById('g'+id);
  if (!mbo || !mbog) return;
  if (mbo.style.display!='') {
    mbo.style.display = '';
    mbog.src = '[IMG:nb_mbox_close.png]';
  }
}

function editAccount(id, atgt) {

  var url = '[CORE_SSTANDURL]&sole=Y&app=CORE&action=NG_MAILEDIT&acc='+id+'&atgt='+atgt;

  if (window.XMLHttpRequest) req = new XMLHttpRequest();
  else if (window.ActiveXObject) {
    isIE = true;
    req = new ActiveXObject("Microsoft.XMLHTTP");
  }	
  if (req) {
    req.onload = function(event) {
      var self = event.target;
      document.getElementById(atgt).innerHTML = self.responseText;
      document.getElementById(atgt).style.position = 'absolute';
      document.getElementById(atgt).style.display = '';
    }
    req.open("GET", url, true);
    req.overrideMimeType('text/xml');
    req.send(null);
  }
}


</script>

<div class="rubrique_title">
<img class="ngbutton" width="25px" valign="absmiddle" src="[IMG:ng_mails.png]" border="0" onclick="editAccount(-1, 'addmail');">&nbsp;[TEXT:mail box]</div>

<div class="rubrique_title" style="border:3px groove; padding:10px; display:none" id="addmail" name="addmail" class="mailaccount">
</div>


[BLOCK MBOX]
<div id="z[imbox]">
<img id="g[imbox]" src="[IMG:nb_mbox_open.png]" title="[TEXT:open/close mailbox]" class="ngbutton" onclick="ShowHideMbox([imbox])" ondblclick="editAccount([imbox], 'addmail');">
<img class="ngbutton" src="[IMG:nb_mbox_view.png]" class="bgbutton" title="[TEXT:retrieve mailbox informations]" onclick="SendMboxRequest([imbox])">&nbsp;[name]&nbsp;?/?</div>
<div style="display:none;" class="mailcontent" id="r[imbox]">[TEXT:not available]</div>[ENDBLOCK MBOX]
<div style="display:none;" id="waiting"><img src="[IMG:nb_mbox_wait.gif]" style="border:0">[TEXT:waiting server respons]</div>
