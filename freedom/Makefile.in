# ============================================
# $Id: Makefile.in,v 1.24 2008/05/07 16:35:35 jerome Exp $
# ============================================
PACKAGE = @PACKAGE@
VERSION = @VERSION@
utildir=@PUBRULE@
appname = @APPNAME@
pubdir = @prefix@
srcdir = @srcdir@
applib = FDL
rootprefix=$(RPM_BUILD_ROOT)
export pubdir utildir appname applib

TAR = gtar
GZIP_ENV = --best

export targetdir PACKAGE

SUBDIR=  Class Zone Action JavaScript Css JavaScript  App Api Share Images Doc debian CONTRIB

include $(utildir)/PubRule

DISTFILES = $(SUBDIR) \
            $(wildcard *.in) \
            VERSION RELEASE $(appname).vault $(appname).cron \
	    $(appname)_en.po $(appname)_fr.po 


$(pubdir)/$(applib) :
	mkdir -p $@

$(pubdir)/img-cache :
	mkdir -p $@

$(rootprefix)/var/freedom:
	mkdir -p $@

$(rootprefix)/etc/cron.d:
	mkdir -p $@

$(rootprefix)/etc/cron.d/$(appname).cron:$(appname).cron $(rootprefix)/etc/cron.d
	cp $(appname).cron $@

$(pubdir)/$(applib)/FREEDOM.vault : FREEDOM.vault
	cp $< $(pubdir)/$(applib)/$<

$(pubdir)/$(applib)/Layout:
	mkdir -p $@

$(pubdir)/$(applib)/Layout/editoptcard.xml: $(pubdir)/$(applib)/Layout
	ln -s editbodycard.xml $@

$(pubdir)/$(applib)/Layout/viewoptcard.xml: $(pubdir)/$(applib)/Layout
	ln -s viewbodycard.xml $@

$(pubdir)/EXTERNALS:
	mkdir -p $@

$(pubdir)/EXTERNALS/fdlsearches.php: $(pubdir)/EXTERNALS
	ln -s ../FDL/fdlsearches.php $@

publish: $(pubdir)/$(applib) $(pubdir)/img-cache  $(pubdir)/$(applib)/FREEDOM.vault $(rootprefix)/etc/cron.d/$(appname).cron $(rootprefix)/var/freedom $(pubdir)/$(applib)/Layout/editoptcard.xml $(pubdir)/$(applib)/Layout/viewoptcard.xml $(pubdir)/EXTERNALS/fdlsearches.php

clean:
	rm -f *.*~ config.* Makefile configure $(PACKAGE).spec \
              $(PACKAGE)-$(VERSION).tar.gz \
              App/Freedom/FREEDOM_init.php \
              App/Freedom/FREEDOM_post \
              App/Fdl/FDL_init.php \
              App/Fdl/FDL_post \
	      App/Usercard/USERCARD_post \
              App/Generic/GENERIC_init.php App/Usercard/USERCARD_init.php \
	      App/Fusers/FUSERS_init.php App/Onefam/ONEFAM_init.php
