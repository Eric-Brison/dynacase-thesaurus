<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- HEAD HTML -->

<html>
  <head>

   <title>[TEXT: choose value]</title>

   <style>
[ZONE CORE:GENCSS]
   </style>


[CSS:REF]


<style type="text/css">
[CSS:CODE]

</style>

[JS:REF]

   <script language="JavaScript1.2">
  <!--
    [JS:CODE]

    
var tattrid= new Array();
    tattrid= [attrid];

var tattrv= new Array();
[BLOCK ATTRVAL]
tattrv[[index]] =[attrv]; 
[ENDBLOCK ATTRVAL]


function completechoice(index) {

    winfo = window.open('','[wname]','');

    for (i=0; i< tattrid.length; i++) {
       winfo.document.getElementById(tattrid[i]).value = tattrv[index][i];
       winfo.document.getElementById(tattrid[i]).style.backgroundColor='[CORE_BGCOLORHIGH]';
//       winfo.document.getElementById(tattrid[i]).style.fontWeight='bold';
    }

}

function completechoices() {

    winfo = window.open('','[wname]','');

    var cvalues = new Array();
    for (i=0; i< tattrid.length; i++) {	
      cvalues[i] ="";
    }
    senum = document.getElementById('schoose');
    for (c=0; c< senum.length; c++) {
      if (senum.options[c].selected) {
	index= senum.options[c].value;
	for (i=0; i< tattrid.length; i++) {	 
	  with (winfo.document.getElementById(tattrid[i])) {
	    if (tattrv[index][i] != "") {
	      cvalues[i] += tattrv[index][i];
	      cvalues[i] += "\n";
	      style.backgroundColor='[CORE_BGCOLORHIGH]';
	    }
	    //       style.fontWeight='bold';
	  }
	}
      }
    }
    for (i=0; i< tattrid.length; i++) {	
      if (cvalues[i][0] != '?')
	winfo.document.getElementById(tattrid[i]).value = cvalues[i];
    }

}
function closeframe(idf) {
    winfo = window.open('','[wname]','');
winfo.document.getElementById(idf).style.visibility='hidden';
}

function resizeIFrame() {

  document.getElementById('dchoose').style.width= document.getElementById('schoose').offsetWidth+2;
  document.getElementById('dchoose').style.height= document.getElementById('schoose').offsetHeight+30;
    winfo = window.open('','[wname]','');
winfo.document.getElementById('choose').style.width= document.getElementById('schoose').offsetWidth+10;
winfo.document.getElementById('choose').style.height= document.getElementById('dchoose').offsetHeight;
}
-->
</script>   
 </head>

<body style="padding:0pt;marging:0pt"
      onLoad="resizeIFrame()">


<div id="dchoose" style="border-width:4px;border-style:groove;border-color:[CORE_FGCOLOR]">
<img src="[IMG:bred.gif]" 
     style="cursor:pointer" 
     onClick="closeframe('choose');"
     title="[TEXT:close]"
     alt="[TEXT:close]">
<br>
<select id="schoose" [multiple]
        style="align:center" 
	size="[nselect]" 
	onChange="completechoices()" >
                    [BLOCK SELECT]
<option value="[cindex]"   >[choice]</option>        
                    [ENDBLOCK SELECT]
</select>


</div>
</body>
</html>
